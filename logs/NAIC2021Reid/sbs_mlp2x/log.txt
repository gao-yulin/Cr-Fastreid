[03/03 06:27:16] fastreid INFO: Rank of current process: 0. World size: 1
[03/03 06:27:18] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/03 06:27:18] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/03 06:27:18] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/03 06:27:18] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 8
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/03 06:27:18] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/03 06:27:18] fastreid.utils.env INFO: Using a generated random seed 18985067
[03/03 06:27:18] fastreid.engine.defaults INFO: Prepare training set
[03/03 06:27:19] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/03 06:27:19] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/03 06:27:20] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/03 06:27:24] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/03 06:34:00] fastreid INFO: Rank of current process: 0. World size: 1
[03/03 06:34:02] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/03 06:34:02] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/03 06:34:02] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/03 06:34:02] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 8
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/03 06:34:02] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/03 06:34:02] fastreid.utils.env INFO: Using a generated random seed 2553225
[03/03 06:34:02] fastreid.engine.defaults INFO: Prepare training set
[03/03 06:34:02] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/03 06:34:02] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/03 06:34:03] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/03 06:34:04] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/03 17:18:14] fastreid INFO: Rank of current process: 0. World size: 1
[03/03 17:18:15] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/03 17:18:15] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/03 17:18:15] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/03 17:18:15] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 8
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/03 17:18:15] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/03 17:18:15] fastreid.utils.env INFO: Using a generated random seed 15999771
[03/03 17:18:15] fastreid.engine.defaults INFO: Prepare training set
[03/03 17:18:16] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/03 17:18:16] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/03 17:18:16] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/03 17:18:19] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/03 17:27:41] fastreid INFO: Rank of current process: 0. World size: 1
[03/03 17:27:43] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/03 17:27:43] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/03 17:27:43] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/03 17:27:43] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 8
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/03 17:27:43] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/03 17:27:43] fastreid.utils.env INFO: Using a generated random seed 43433480
[03/03 17:27:43] fastreid.engine.defaults INFO: Prepare training set
[03/03 17:27:43] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/03 17:27:43] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/03 17:27:44] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/03 17:27:46] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/03 17:28:17] fastreid INFO: Rank of current process: 0. World size: 1
[03/03 17:28:18] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/03 17:28:18] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/03 17:28:18] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/03 17:28:18] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 8
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/03 17:28:18] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/03 17:28:18] fastreid.utils.env INFO: Using a generated random seed 18861292
[03/03 17:28:18] fastreid.engine.defaults INFO: Prepare training set
[03/03 17:28:19] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/03 17:28:19] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/03 17:28:19] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/03 17:28:21] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/03 17:32:18] fastreid INFO: Rank of current process: 0. World size: 1
[03/03 17:32:20] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/03 17:32:20] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/03 17:32:20] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/03 17:32:20] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 8
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/03 17:32:20] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/03 17:32:20] fastreid.utils.env INFO: Using a generated random seed 20583125
[03/03 17:32:20] fastreid.engine.defaults INFO: Prepare training set
[03/03 17:32:21] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/03 17:32:21] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/03 17:32:21] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/03 17:32:26] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 02:06:11] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 02:06:12] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 02:06:12] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 02:06:12] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 02:06:12] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 02:06:12] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 02:06:12] fastreid.utils.env INFO: Using a generated random seed 12684826
[03/04 02:06:12] fastreid.engine.defaults INFO: Prepare training set
[03/04 02:06:13] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/04 02:06:13] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 02:06:13] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 02:06:15] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 02:21:59] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 02:22:01] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 02:22:01] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 02:22:01] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 02:22:01] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 02:22:01] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 02:22:01] fastreid.utils.env INFO: Using a generated random seed 1255093
[03/04 02:22:01] fastreid.engine.defaults INFO: Prepare training set
[03/04 02:22:01] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/04 02:22:01] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 02:22:01] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 02:22:03] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 02:54:07] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 02:54:08] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 02:54:08] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 02:54:08] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 02:54:08] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 02:54:08] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 02:54:08] fastreid.utils.env INFO: Using a generated random seed 8754894
[03/04 02:54:08] fastreid.engine.defaults INFO: Prepare training set
[03/04 02:54:09] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/04 02:54:09] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 02:54:09] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 02:54:11] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 02:55:44] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 02:55:46] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 02:55:46] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 02:55:46] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 02:55:46] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 02:55:46] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 02:55:46] fastreid.utils.env INFO: Using a generated random seed 46176786
[03/04 02:55:46] fastreid.engine.defaults INFO: Prepare training set
[03/04 02:55:46] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129654     | 1           |[0m
[03/04 02:55:46] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 02:55:46] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 02:55:49] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 02:56:52] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 02:56:54] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 02:56:54] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 02:56:54] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 02:56:54] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 02:56:54] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 02:56:54] fastreid.utils.env INFO: Using a generated random seed 54093169
[03/04 02:56:54] fastreid.engine.defaults INFO: Prepare training set
[03/04 02:56:54] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129653     | 1           |[0m
[03/04 02:56:54] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 02:56:54] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 02:56:56] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 02:57:40] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 02:57:41] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 02:57:41] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 02:57:41] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 02:57:41] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 02:57:41] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 02:57:41] fastreid.utils.env INFO: Using a generated random seed 41945152
[03/04 02:57:41] fastreid.engine.defaults INFO: Prepare training set
[03/04 02:57:42] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129652     | 1           |[0m
[03/04 02:57:42] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 02:57:42] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 02:57:44] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 02:58:20] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 02:58:22] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 02:58:22] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 02:58:22] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 02:58:22] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 02:58:22] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 02:58:22] fastreid.utils.env INFO: Using a generated random seed 22520292
[03/04 02:58:22] fastreid.engine.defaults INFO: Prepare training set
[03/04 02:58:23] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129651     | 1           |[0m
[03/04 02:58:23] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 02:58:23] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 02:58:25] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 03:05:07] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 03:05:09] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 03:05:09] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 03:05:09] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 03:05:09] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 03:05:09] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 03:05:09] fastreid.utils.env INFO: Using a generated random seed 9499343
[03/04 03:05:09] fastreid.engine.defaults INFO: Prepare training set
[03/04 03:05:10] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129650     | 1           |[0m
[03/04 03:05:10] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 03:05:10] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 03:05:12] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 03:05:42] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 03:05:44] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 03:05:44] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 03:05:44] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 03:05:44] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 03:05:44] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 03:05:44] fastreid.utils.env INFO: Using a generated random seed 44280602
[03/04 03:05:44] fastreid.engine.defaults INFO: Prepare training set
[03/04 03:05:44] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129649     | 1           |[0m
[03/04 03:05:44] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 03:05:45] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 03:05:46] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 03:06:16] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 03:06:18] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 03:06:18] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 03:06:18] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 03:06:18] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 03:06:18] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 03:06:18] fastreid.utils.env INFO: Using a generated random seed 18281291
[03/04 03:06:18] fastreid.engine.defaults INFO: Prepare training set
[03/04 03:06:18] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129648     | 1           |[0m
[03/04 03:06:18] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 03:06:18] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 03:06:21] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 03:20:11] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 03:20:13] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 03:20:13] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 03:20:13] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 03:20:13] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 03:20:13] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 03:20:13] fastreid.utils.env INFO: Using a generated random seed 13465291
[03/04 03:20:13] fastreid.engine.defaults INFO: Prepare training set
[03/04 03:20:13] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/04 03:20:13] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 03:20:13] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/04 03:20:15] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/04 03:20:15] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/04 03:20:15] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/04 03:20:16] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File ".\fastreid\engine\train_loop.py", line 145, in train
    self.run_step()
  File ".\fastreid\engine\defaults.py", line 359, in run_step
    self._trainer.run_step()
  File ".\fastreid\engine\train_loop.py", line 343, in run_step
    loss_dict = self.model(data)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\meta_arch\baseline.py", line 101, in forward
    features = self.backbone(images)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\container.py", line 141, in forward
    input = module(input)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\backbones\mlp.py", line 29, in forward
    assert x.ndim == 4 and x.shape[2] == x.shape[3] == 1
AssertionError
[03/04 03:20:16] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/04 03:25:28] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 03:25:29] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 03:25:29] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 03:25:29] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 03:25:29] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 03:25:29] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 03:25:29] fastreid.utils.env INFO: Using a generated random seed 29585288
[03/04 03:25:29] fastreid.engine.defaults INFO: Prepare training set
[03/04 03:25:29] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/04 03:25:29] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 03:25:29] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/04 03:25:31] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/04 03:25:32] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/04 03:25:32] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/04 03:25:32] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File ".\fastreid\engine\train_loop.py", line 145, in train
    self.run_step()
  File ".\fastreid\engine\defaults.py", line 359, in run_step
    self._trainer.run_step()
  File ".\fastreid\engine\train_loop.py", line 343, in run_step
    loss_dict = self.model(data)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\meta_arch\baseline.py", line 101, in forward
    features = self.backbone(images)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\container.py", line 141, in forward
    input = module(input)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\backbones\mlp.py", line 32, in forward
    assert x.ndim == 4 and x.shape[2] == x.shape[3] == 1
AssertionError
[03/04 03:25:32] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/04 08:51:37] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 08:51:39] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 08:51:39] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 08:51:39] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 08:51:39] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 08:51:39] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 08:51:39] fastreid.utils.env INFO: Using a generated random seed 39615940
[03/04 08:51:39] fastreid.engine.defaults INFO: Prepare training set
[03/04 08:51:39] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/04 08:51:39] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 08:51:39] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/04 08:51:42] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/04 08:51:42] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/04 08:51:42] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/04 08:51:43] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File ".\fastreid\engine\train_loop.py", line 145, in train
    self.run_step()
  File ".\fastreid\engine\defaults.py", line 359, in run_step
    self._trainer.run_step()
  File ".\fastreid\engine\train_loop.py", line 343, in run_step
    loss_dict = self.model(data)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\meta_arch\baseline.py", line 101, in forward
    features = self.backbone(images)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\container.py", line 141, in forward
    input = module(input)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\backbones\mlp.py", line 34, in forward
    assert x.ndim == 4 and x.shape[2] == x.shape[3] == 1
AssertionError
[03/04 08:51:43] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/04 09:09:05] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 09:09:07] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 09:09:07] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 09:09:07] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 09:09:07] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 09:09:07] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 09:09:07] fastreid.utils.env INFO: Using a generated random seed 7117606
[03/04 09:09:07] fastreid.engine.defaults INFO: Prepare training set
[03/04 09:09:07] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/04 09:09:07] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 09:09:07] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/04 09:09:09] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/04 09:09:10] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/04 09:09:10] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/04 09:09:11] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File ".\fastreid\engine\train_loop.py", line 145, in train
    self.run_step()
  File ".\fastreid\engine\defaults.py", line 359, in run_step
    self._trainer.run_step()
  File ".\fastreid\engine\train_loop.py", line 343, in run_step
    loss_dict = self.model(data)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\meta_arch\baseline.py", line 101, in forward
    features = self.backbone(images)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\container.py", line 141, in forward
    input = module(input)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\backbones\mlp.py", line 34, in forward
    assert x.ndim == 4 and x.shape[2] == x.shape[3] == 1
AssertionError
[03/04 09:09:11] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/04 09:09:33] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 09:09:35] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 09:09:35] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 09:09:35] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 09:09:35] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 09:09:35] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 09:09:35] fastreid.utils.env INFO: Using a generated random seed 35943775
[03/04 09:09:35] fastreid.engine.defaults INFO: Prepare training set
[03/04 09:09:35] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/04 09:09:35] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 09:09:36] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/04 09:09:38] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/04 09:09:38] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/04 09:09:38] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/04 09:09:39] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File ".\fastreid\engine\train_loop.py", line 145, in train
    self.run_step()
  File ".\fastreid\engine\defaults.py", line 359, in run_step
    self._trainer.run_step()
  File ".\fastreid\engine\train_loop.py", line 343, in run_step
    loss_dict = self.model(data)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\meta_arch\baseline.py", line 101, in forward
    features = self.backbone(images)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\container.py", line 141, in forward
    input = module(input)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\backbones\mlp.py", line 34, in forward
    assert x.ndim == 4 and x.shape[2] == x.shape[3] == 1
AssertionError
[03/04 09:09:39] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/07 01:07:57] fastreid INFO: Rank of current process: 0. World size: 1
[03/07 01:07:59] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/07 01:07:59] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/07 01:07:59] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/07 01:07:59] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/07 01:07:59] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/07 01:07:59] fastreid.utils.env INFO: Using a generated random seed 59665548
[03/07 01:07:59] fastreid.engine.defaults INFO: Prepare training set
[03/07 01:07:59] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/07 01:07:59] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/07 01:07:59] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/07 01:08:02] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/07 01:10:22] fastreid INFO: Rank of current process: 0. World size: 1
[03/07 01:10:23] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/07 01:10:23] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/07 01:10:23] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/07 01:10:23] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/07 01:10:23] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/07 01:10:23] fastreid.utils.env INFO: Using a generated random seed 23921295
[03/07 01:10:23] fastreid.engine.defaults INFO: Prepare training set
[03/07 01:10:23] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/07 01:10:23] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/07 01:10:23] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/07 01:10:26] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/07 01:10:26] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/07 01:10:26] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/07 01:10:31] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File ".\fastreid\engine\train_loop.py", line 145, in train
    self.run_step()
  File ".\fastreid\engine\defaults.py", line 359, in run_step
    self._trainer.run_step()
  File ".\fastreid\engine\train_loop.py", line 347, in run_step
    self.grad_scaler.scale(losses).backward()
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\_tensor.py", line 307, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\autograd\__init__.py", line 156, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
RuntimeError: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling `cublasGemmEx( handle, opa, opb, m, n, k, &falpha, a, CUDA_R_16F, lda, b, CUDA_R_16F, ldb, &fbeta, c, CUDA_R_16F, ldc, CUDA_R_32F, CUBLAS_GEMM_DFALT_TENSOR_OP)`
[03/07 01:10:31] fastreid.engine.hooks INFO: Total training time: 0:00:04 (0:00:00 on hooks)
[03/07 03:34:10] fastreid INFO: Rank of current process: 0. World size: 1
[03/07 03:34:12] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/07 03:34:12] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/07 03:34:12] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/07 03:34:12] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/07 03:34:12] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/07 03:34:12] fastreid.utils.env INFO: Using a generated random seed 12508844
[03/07 03:34:12] fastreid.engine.defaults INFO: Prepare training set
[03/07 03:34:12] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/07 03:34:12] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/07 03:34:12] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/07 03:34:15] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/07 03:34:15] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/07 03:34:15] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/07 03:34:16] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File ".\fastreid\engine\train_loop.py", line 145, in train
    self.run_step()
  File ".\fastreid\engine\defaults.py", line 359, in run_step
    self._trainer.run_step()
  File ".\fastreid\engine\train_loop.py", line 347, in run_step
    self.grad_scaler.scale(losses).backward()
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\_tensor.py", line 307, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\autograd\__init__.py", line 156, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
RuntimeError: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling `cublasGemmEx( handle, opa, opb, m, n, k, &falpha, a, CUDA_R_16F, lda, b, CUDA_R_16F, ldb, &fbeta, c, CUDA_R_16F, ldc, CUDA_R_32F, CUBLAS_GEMM_DFALT_TENSOR_OP)`
[03/07 03:34:16] fastreid.engine.hooks INFO: Total training time: 0:00:01 (0:00:00 on hooks)
[03/07 03:44:08] fastreid INFO: Rank of current process: 0. World size: 1
[03/07 03:44:09] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/07 03:44:09] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/07 03:44:09] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/07 03:44:09] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: False
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/07 03:44:09] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/07 03:44:09] fastreid.utils.env INFO: Using a generated random seed 9378394
[03/07 03:44:09] fastreid.engine.defaults INFO: Prepare training set
[03/07 03:44:09] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/07 03:44:09] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/07 03:44:09] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/07 03:44:11] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/07 03:44:11] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/07 03:44:11] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/07 03:44:14] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File ".\fastreid\engine\train_loop.py", line 145, in train
    self.run_step()
  File ".\fastreid\engine\defaults.py", line 359, in run_step
    self._trainer.run_step()
  File ".\fastreid\engine\train_loop.py", line 347, in run_step
    self.grad_scaler.scale(losses).backward()
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\_tensor.py", line 307, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\autograd\__init__.py", line 156, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
RuntimeError: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling `cublasGemmEx( handle, opa, opb, m, n, k, &falpha, a, CUDA_R_16F, lda, b, CUDA_R_16F, ldb, &fbeta, c, CUDA_R_16F, ldc, CUDA_R_32F, CUBLAS_GEMM_DFALT_TENSOR_OP)`
[03/07 03:44:14] fastreid.engine.hooks INFO: Total training time: 0:00:03 (0:00:00 on hooks)
