[03/03 06:27:16] fastreid INFO: Rank of current process: 0. World size: 1
[03/03 06:27:18] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/03 06:27:18] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/03 06:27:18] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/03 06:27:18] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 8
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/03 06:27:18] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/03 06:27:18] fastreid.utils.env INFO: Using a generated random seed 18985067
[03/03 06:27:18] fastreid.engine.defaults INFO: Prepare training set
[03/03 06:27:19] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/03 06:27:19] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/03 06:27:20] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/03 06:27:24] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/03 06:34:00] fastreid INFO: Rank of current process: 0. World size: 1
[03/03 06:34:02] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/03 06:34:02] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/03 06:34:02] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/03 06:34:02] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 8
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/03 06:34:02] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/03 06:34:02] fastreid.utils.env INFO: Using a generated random seed 2553225
[03/03 06:34:02] fastreid.engine.defaults INFO: Prepare training set
[03/03 06:34:02] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/03 06:34:02] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/03 06:34:03] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/03 06:34:04] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/03 17:18:14] fastreid INFO: Rank of current process: 0. World size: 1
[03/03 17:18:15] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/03 17:18:15] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/03 17:18:15] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/03 17:18:15] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 8
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/03 17:18:15] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/03 17:18:15] fastreid.utils.env INFO: Using a generated random seed 15999771
[03/03 17:18:15] fastreid.engine.defaults INFO: Prepare training set
[03/03 17:18:16] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/03 17:18:16] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/03 17:18:16] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/03 17:18:19] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/03 17:27:41] fastreid INFO: Rank of current process: 0. World size: 1
[03/03 17:27:43] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/03 17:27:43] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/03 17:27:43] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/03 17:27:43] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 8
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/03 17:27:43] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/03 17:27:43] fastreid.utils.env INFO: Using a generated random seed 43433480
[03/03 17:27:43] fastreid.engine.defaults INFO: Prepare training set
[03/03 17:27:43] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/03 17:27:43] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/03 17:27:44] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/03 17:27:46] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/03 17:28:17] fastreid INFO: Rank of current process: 0. World size: 1
[03/03 17:28:18] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/03 17:28:18] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/03 17:28:18] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/03 17:28:18] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 8
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/03 17:28:18] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/03 17:28:18] fastreid.utils.env INFO: Using a generated random seed 18861292
[03/03 17:28:18] fastreid.engine.defaults INFO: Prepare training set
[03/03 17:28:19] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/03 17:28:19] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/03 17:28:19] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/03 17:28:21] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/03 17:32:18] fastreid INFO: Rank of current process: 0. World size: 1
[03/03 17:32:20] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/03 17:32:20] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/03 17:32:20] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/03 17:32:20] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 8
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/03 17:32:20] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/03 17:32:20] fastreid.utils.env INFO: Using a generated random seed 20583125
[03/03 17:32:20] fastreid.engine.defaults INFO: Prepare training set
[03/03 17:32:21] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/03 17:32:21] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/03 17:32:21] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/03 17:32:26] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 02:06:11] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 02:06:12] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 02:06:12] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 02:06:12] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 02:06:12] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 02:06:12] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 02:06:12] fastreid.utils.env INFO: Using a generated random seed 12684826
[03/04 02:06:12] fastreid.engine.defaults INFO: Prepare training set
[03/04 02:06:13] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/04 02:06:13] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 02:06:13] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 02:06:15] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 02:21:59] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 02:22:01] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 02:22:01] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 02:22:01] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 02:22:01] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 02:22:01] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 02:22:01] fastreid.utils.env INFO: Using a generated random seed 1255093
[03/04 02:22:01] fastreid.engine.defaults INFO: Prepare training set
[03/04 02:22:01] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/04 02:22:01] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 02:22:01] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 02:22:03] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 02:54:07] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 02:54:08] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 02:54:08] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 02:54:08] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 02:54:08] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 02:54:08] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 02:54:08] fastreid.utils.env INFO: Using a generated random seed 8754894
[03/04 02:54:08] fastreid.engine.defaults INFO: Prepare training set
[03/04 02:54:09] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129655     | 1           |[0m
[03/04 02:54:09] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 02:54:09] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 02:54:11] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 02:55:44] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 02:55:46] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 02:55:46] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 02:55:46] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 02:55:46] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 02:55:46] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 02:55:46] fastreid.utils.env INFO: Using a generated random seed 46176786
[03/04 02:55:46] fastreid.engine.defaults INFO: Prepare training set
[03/04 02:55:46] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129654     | 1           |[0m
[03/04 02:55:46] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 02:55:46] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 02:55:49] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 02:56:52] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 02:56:54] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 02:56:54] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 02:56:54] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 02:56:54] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 02:56:54] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 02:56:54] fastreid.utils.env INFO: Using a generated random seed 54093169
[03/04 02:56:54] fastreid.engine.defaults INFO: Prepare training set
[03/04 02:56:54] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129653     | 1           |[0m
[03/04 02:56:54] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 02:56:54] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 02:56:56] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 02:57:40] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 02:57:41] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 02:57:41] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 02:57:41] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 02:57:41] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 02:57:41] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 02:57:41] fastreid.utils.env INFO: Using a generated random seed 41945152
[03/04 02:57:41] fastreid.engine.defaults INFO: Prepare training set
[03/04 02:57:42] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129652     | 1           |[0m
[03/04 02:57:42] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 02:57:42] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 02:57:44] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 02:58:20] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 02:58:22] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 02:58:22] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 02:58:22] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 02:58:22] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 02:58:22] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 02:58:22] fastreid.utils.env INFO: Using a generated random seed 22520292
[03/04 02:58:22] fastreid.engine.defaults INFO: Prepare training set
[03/04 02:58:23] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129651     | 1           |[0m
[03/04 02:58:23] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 02:58:23] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 02:58:25] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 03:05:07] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 03:05:09] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 03:05:09] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 03:05:09] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 03:05:09] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 03:05:09] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 03:05:09] fastreid.utils.env INFO: Using a generated random seed 9499343
[03/04 03:05:09] fastreid.engine.defaults INFO: Prepare training set
[03/04 03:05:10] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129650     | 1           |[0m
[03/04 03:05:10] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 03:05:10] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 03:05:12] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 03:05:42] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 03:05:44] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 03:05:44] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 03:05:44] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 03:05:44] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 03:05:44] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 03:05:44] fastreid.utils.env INFO: Using a generated random seed 44280602
[03/04 03:05:44] fastreid.engine.defaults INFO: Prepare training set
[03/04 03:05:44] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129649     | 1           |[0m
[03/04 03:05:44] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 03:05:45] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 03:05:46] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 03:06:16] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 03:06:18] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 03:06:18] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 03:06:18] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 03:06:18] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 03:06:18] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 03:06:18] fastreid.utils.env INFO: Using a generated random seed 18281291
[03/04 03:06:18] fastreid.engine.defaults INFO: Prepare training set
[03/04 03:06:18] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 5395    | 129648     | 1           |[0m
[03/04 03:06:18] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 03:06:18] fastreid.engine.defaults INFO: Auto-scaling the num_classes=5395
[03/04 03:06:21] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=5395, scale=64, margin=0.35)
  )
)
[03/04 03:20:11] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 03:20:13] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 03:20:13] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 03:20:13] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 03:20:13] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 03:20:13] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 03:20:13] fastreid.utils.env INFO: Using a generated random seed 13465291
[03/04 03:20:13] fastreid.engine.defaults INFO: Prepare training set
[03/04 03:20:13] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/04 03:20:13] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 03:20:13] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/04 03:20:15] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/04 03:20:15] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/04 03:20:15] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/04 03:20:16] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File ".\fastreid\engine\train_loop.py", line 145, in train
    self.run_step()
  File ".\fastreid\engine\defaults.py", line 359, in run_step
    self._trainer.run_step()
  File ".\fastreid\engine\train_loop.py", line 343, in run_step
    loss_dict = self.model(data)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\meta_arch\baseline.py", line 101, in forward
    features = self.backbone(images)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\container.py", line 141, in forward
    input = module(input)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\backbones\mlp.py", line 29, in forward
    assert x.ndim == 4 and x.shape[2] == x.shape[3] == 1
AssertionError
[03/04 03:20:16] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/04 03:25:28] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 03:25:29] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 03:25:29] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 03:25:29] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 03:25:29] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 03:25:29] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 03:25:29] fastreid.utils.env INFO: Using a generated random seed 29585288
[03/04 03:25:29] fastreid.engine.defaults INFO: Prepare training set
[03/04 03:25:29] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/04 03:25:29] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 03:25:29] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/04 03:25:31] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/04 03:25:32] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/04 03:25:32] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/04 03:25:32] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File ".\fastreid\engine\train_loop.py", line 145, in train
    self.run_step()
  File ".\fastreid\engine\defaults.py", line 359, in run_step
    self._trainer.run_step()
  File ".\fastreid\engine\train_loop.py", line 343, in run_step
    loss_dict = self.model(data)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\meta_arch\baseline.py", line 101, in forward
    features = self.backbone(images)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\container.py", line 141, in forward
    input = module(input)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\backbones\mlp.py", line 32, in forward
    assert x.ndim == 4 and x.shape[2] == x.shape[3] == 1
AssertionError
[03/04 03:25:32] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/04 08:51:37] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 08:51:39] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 08:51:39] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 08:51:39] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 08:51:39] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 08:51:39] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 08:51:39] fastreid.utils.env INFO: Using a generated random seed 39615940
[03/04 08:51:39] fastreid.engine.defaults INFO: Prepare training set
[03/04 08:51:39] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/04 08:51:39] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 08:51:39] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/04 08:51:42] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/04 08:51:42] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/04 08:51:42] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/04 08:51:43] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File ".\fastreid\engine\train_loop.py", line 145, in train
    self.run_step()
  File ".\fastreid\engine\defaults.py", line 359, in run_step
    self._trainer.run_step()
  File ".\fastreid\engine\train_loop.py", line 343, in run_step
    loss_dict = self.model(data)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\meta_arch\baseline.py", line 101, in forward
    features = self.backbone(images)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\container.py", line 141, in forward
    input = module(input)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\backbones\mlp.py", line 34, in forward
    assert x.ndim == 4 and x.shape[2] == x.shape[3] == 1
AssertionError
[03/04 08:51:43] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/04 09:09:05] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 09:09:07] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 09:09:07] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 09:09:07] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 09:09:07] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 09:09:07] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 09:09:07] fastreid.utils.env INFO: Using a generated random seed 7117606
[03/04 09:09:07] fastreid.engine.defaults INFO: Prepare training set
[03/04 09:09:07] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/04 09:09:07] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 09:09:07] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/04 09:09:09] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/04 09:09:10] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/04 09:09:10] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/04 09:09:11] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File ".\fastreid\engine\train_loop.py", line 145, in train
    self.run_step()
  File ".\fastreid\engine\defaults.py", line 359, in run_step
    self._trainer.run_step()
  File ".\fastreid\engine\train_loop.py", line 343, in run_step
    loss_dict = self.model(data)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\meta_arch\baseline.py", line 101, in forward
    features = self.backbone(images)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\container.py", line 141, in forward
    input = module(input)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\backbones\mlp.py", line 34, in forward
    assert x.ndim == 4 and x.shape[2] == x.shape[3] == 1
AssertionError
[03/04 09:09:11] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/04 09:09:33] fastreid INFO: Rank of current process: 0. World size: 1
[03/04 09:09:35] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/04 09:09:35] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/04 09:09:35] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/04 09:09:35] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/04 09:09:35] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/04 09:09:35] fastreid.utils.env INFO: Using a generated random seed 35943775
[03/04 09:09:35] fastreid.engine.defaults INFO: Prepare training set
[03/04 09:09:35] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/04 09:09:35] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/04 09:09:36] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/04 09:09:38] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/04 09:09:38] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/04 09:09:38] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/04 09:09:39] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File ".\fastreid\engine\train_loop.py", line 145, in train
    self.run_step()
  File ".\fastreid\engine\defaults.py", line 359, in run_step
    self._trainer.run_step()
  File ".\fastreid\engine\train_loop.py", line 343, in run_step
    loss_dict = self.model(data)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\meta_arch\baseline.py", line 101, in forward
    features = self.backbone(images)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\container.py", line 141, in forward
    input = module(input)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File ".\fastreid\modeling\backbones\mlp.py", line 34, in forward
    assert x.ndim == 4 and x.shape[2] == x.shape[3] == 1
AssertionError
[03/04 09:09:39] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/07 01:07:57] fastreid INFO: Rank of current process: 0. World size: 1
[03/07 01:07:59] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/07 01:07:59] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/07 01:07:59] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/07 01:07:59] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/07 01:07:59] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/07 01:07:59] fastreid.utils.env INFO: Using a generated random seed 59665548
[03/07 01:07:59] fastreid.engine.defaults INFO: Prepare training set
[03/07 01:07:59] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/07 01:07:59] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/07 01:07:59] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/07 01:08:02] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/07 01:10:22] fastreid INFO: Rank of current process: 0. World size: 1
[03/07 01:10:23] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/07 01:10:23] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/07 01:10:23] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/07 01:10:23] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/07 01:10:23] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/07 01:10:23] fastreid.utils.env INFO: Using a generated random seed 23921295
[03/07 01:10:23] fastreid.engine.defaults INFO: Prepare training set
[03/07 01:10:23] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/07 01:10:23] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/07 01:10:23] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/07 01:10:26] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/07 01:10:26] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/07 01:10:26] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/07 01:10:31] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File ".\fastreid\engine\train_loop.py", line 145, in train
    self.run_step()
  File ".\fastreid\engine\defaults.py", line 359, in run_step
    self._trainer.run_step()
  File ".\fastreid\engine\train_loop.py", line 347, in run_step
    self.grad_scaler.scale(losses).backward()
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\_tensor.py", line 307, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\autograd\__init__.py", line 156, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
RuntimeError: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling `cublasGemmEx( handle, opa, opb, m, n, k, &falpha, a, CUDA_R_16F, lda, b, CUDA_R_16F, ldb, &fbeta, c, CUDA_R_16F, ldc, CUDA_R_32F, CUBLAS_GEMM_DFALT_TENSOR_OP)`
[03/07 01:10:31] fastreid.engine.hooks INFO: Total training time: 0:00:04 (0:00:00 on hooks)
[03/07 03:34:10] fastreid INFO: Rank of current process: 0. World size: 1
[03/07 03:34:12] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/07 03:34:12] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/07 03:34:12] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/07 03:34:12] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/07 03:34:12] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/07 03:34:12] fastreid.utils.env INFO: Using a generated random seed 12508844
[03/07 03:34:12] fastreid.engine.defaults INFO: Prepare training set
[03/07 03:34:12] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/07 03:34:12] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/07 03:34:12] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/07 03:34:15] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/07 03:34:15] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/07 03:34:15] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/07 03:34:16] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File ".\fastreid\engine\train_loop.py", line 145, in train
    self.run_step()
  File ".\fastreid\engine\defaults.py", line 359, in run_step
    self._trainer.run_step()
  File ".\fastreid\engine\train_loop.py", line 347, in run_step
    self.grad_scaler.scale(losses).backward()
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\_tensor.py", line 307, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\autograd\__init__.py", line 156, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
RuntimeError: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling `cublasGemmEx( handle, opa, opb, m, n, k, &falpha, a, CUDA_R_16F, lda, b, CUDA_R_16F, ldb, &fbeta, c, CUDA_R_16F, ldc, CUDA_R_32F, CUBLAS_GEMM_DFALT_TENSOR_OP)`
[03/07 03:34:16] fastreid.engine.hooks INFO: Total training time: 0:00:01 (0:00:00 on hooks)
[03/07 03:44:08] fastreid INFO: Rank of current process: 0. World size: 1
[03/07 03:44:09] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------
sys.platform            win32
Python                  3.7.11 (default, Jul 27 2021, 09:42:29) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.5
fastreid                1.3 @.\fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1650
CUDA_HOME               None
Pillow                  8.4.0
torchvision             0.11.3 @C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision
torchvision arch flags  C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torchvision\_C.pyd
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[03/07 03:44:09] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/07 03:44:09] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/07 03:44:09] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: False
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/07 03:44:09] fastreid INFO: Full config saved to C:\Users\yling\Documents\naic\project\logs\NAIC2021Reid\sbs_mlp2x\config.yaml
[03/07 03:44:09] fastreid.utils.env INFO: Using a generated random seed 9378394
[03/07 03:44:09] fastreid.engine.defaults INFO: Prepare training set
[03/07 03:44:09] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/07 03:44:09] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/07 03:44:09] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/07 03:44:11] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/07 03:44:11] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/07 03:44:11] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/07 03:44:14] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File ".\fastreid\engine\train_loop.py", line 145, in train
    self.run_step()
  File ".\fastreid\engine\defaults.py", line 359, in run_step
    self._trainer.run_step()
  File ".\fastreid\engine\train_loop.py", line 347, in run_step
    self.grad_scaler.scale(losses).backward()
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\_tensor.py", line 307, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "C:\Users\yling\anaconda3\envs\fastreid\lib\site-packages\torch\autograd\__init__.py", line 156, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
RuntimeError: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling `cublasGemmEx( handle, opa, opb, m, n, k, &falpha, a, CUDA_R_16F, lda, b, CUDA_R_16F, ldb, &fbeta, c, CUDA_R_16F, ldc, CUDA_R_32F, CUBLAS_GEMM_DFALT_TENSOR_OP)`
[03/07 03:44:14] fastreid.engine.hooks INFO: Total training time: 0:00:03 (0:00:00 on hooks)
[03/08 02:31:14] fastreid INFO: Rank of current process: 0. World size: 1
[03/08 02:31:14] fastreid INFO: Environment info:
-------------------  ----------------------------------------------------------------------------------
sys.platform         linux
Python               3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                1.21.2
fastreid             1.3 @./fastreid
FASTREID_ENV_MODULE  <not set>
PyTorch              1.6.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build  False
GPU available        False
Pillow               9.0.1
torchvision          0.7.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
cv2                  4.5.5
-------------------  ----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[03/08 02:31:14] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[03/08 02:31:14] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/08 02:31:14] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/08 02:31:14] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/08 02:31:14] fastreid.utils.env INFO: Using a generated random seed 14848508
[03/08 02:31:14] fastreid.engine.defaults INFO: Prepare training set
[03/08 02:31:14] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/08 02:31:14] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/08 03:11:03] fastreid INFO: Rank of current process: 0. World size: 1
[03/08 03:11:04] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               None
Pillow                  9.0.1
torchvision             0.7.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision/_C.so
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[03/08 03:11:04] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/08 03:11:04] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/08 03:11:04] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/08 03:11:04] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/08 03:11:04] fastreid.utils.env INFO: Using a generated random seed 4932151
[03/08 03:11:04] fastreid.engine.defaults INFO: Prepare training set
[03/08 03:11:04] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/08 03:11:04] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/08 03:11:07] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/08 03:11:07] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/08 03:11:07] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/08 03:11:07] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/08 03:11:07] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "./fastreid/engine/train_loop.py", line 145, in train
    self.run_step()
  File "./fastreid/engine/defaults.py", line 359, in run_step
    self._trainer.run_step()
  File "./fastreid/engine/train_loop.py", line 347, in run_step
    self.grad_scaler.scale(losses).backward()
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/tensor.py", line 185, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/autograd/__init__.py", line 127, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling `cublasGemmEx( handle, opa, opb, m, n, k, &falpha, a, CUDA_R_16F, lda, b, CUDA_R_16F, ldb, &fbeta, c, CUDA_R_16F, ldc, CUDA_R_32F, CUBLAS_GEMM_DFALT_TENSOR_OP)`
Exception raised from gemm<c10::Half> at /opt/conda/conda-bld/pytorch_1595629427478/work/aten/src/ATen/cuda/CUDABlas.cpp:226 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x4d (0x7f70a284e77d in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xcda774 (0x7f70a3cda774 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #2: at::native::(anonymous namespace)::addmm_out_cuda_impl(at::Tensor&, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar, c10::Scalar) + 0x1074 (0x7f70a5043bc4 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #3: at::native::mm_cuda(at::Tensor const&, at::Tensor const&) + 0xb3 (0x7f70a50455c3 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd04d20 (0x7f70a3d04d20 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0x7b1990 (0x7f70d9bb1990 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #6: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7f70da399c7c in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #7: at::mm(at::Tensor const&, at::Tensor const&) + 0x4b (0x7f70da2eab0b in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #8: <unknown function> + 0x2c2be8f (0x7f70dc02be8f in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x7b1990 (0x7f70d9bb1990 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7f70da399c7c in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::Tensor::mm(at::Tensor const&) const + 0x4b (0x7f70da48010b in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #12: <unknown function> + 0x2a6d41b (0x7f70dbe6d41b in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #13: torch::autograd::generated::MmBackward::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&) + 0x25f (0x7f70dbe88c3f in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x30d1017 (0x7f70dc4d1017 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #15: torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&) + 0x1400 (0x7f70dc4cc860 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #16: torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&) + 0x451 (0x7f70dc4cd401 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #17: torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x89 (0x7f70dc4c5579 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #18: torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x4a (0x7f70e0d2a99a in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #19: <unknown function> + 0xc9039 (0x7f70f5dbc039 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/../../../.././libstdc++.so.6)
frame #20: <unknown function> + 0x8d5c2 (0x7f70fd75c5c2 in /usr/lib/libc.so.6)
frame #21: clone + 0x44 (0x7f70fd7e1584 in /usr/lib/libc.so.6)

[03/08 03:11:07] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/08 03:20:45] fastreid INFO: Rank of current process: 0. World size: 1
[03/08 03:20:46] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               None
Pillow                  9.0.1
torchvision             0.7.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision/_C.so
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[03/08 03:20:46] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/08 03:20:46] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/08 03:20:46] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 16
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/08 03:20:46] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/08 03:20:46] fastreid.utils.env INFO: Using a generated random seed 46151854
[03/08 03:20:46] fastreid.engine.defaults INFO: Prepare training set
[03/08 03:20:46] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/08 03:20:46] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/08 03:20:47] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/08 03:20:47] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/08 03:20:47] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/08 03:20:47] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/08 03:20:48] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "./fastreid/engine/train_loop.py", line 145, in train
    self.run_step()
  File "./fastreid/engine/defaults.py", line 359, in run_step
    self._trainer.run_step()
  File "./fastreid/engine/train_loop.py", line 347, in run_step
    self.grad_scaler.scale(losses).backward()
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/tensor.py", line 185, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/autograd/__init__.py", line 127, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling `cublasGemmEx( handle, opa, opb, m, n, k, &falpha, a, CUDA_R_16F, lda, b, CUDA_R_16F, ldb, &fbeta, c, CUDA_R_16F, ldc, CUDA_R_32F, CUBLAS_GEMM_DFALT_TENSOR_OP)`
Exception raised from gemm<c10::Half> at /opt/conda/conda-bld/pytorch_1595629427478/work/aten/src/ATen/cuda/CUDABlas.cpp:226 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x4d (0x7f6bb7e4e77d in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xcda774 (0x7f6bb92da774 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #2: at::native::(anonymous namespace)::addmm_out_cuda_impl(at::Tensor&, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar, c10::Scalar) + 0x1074 (0x7f6bba643bc4 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #3: at::native::mm_cuda(at::Tensor const&, at::Tensor const&) + 0xb3 (0x7f6bba6455c3 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd04d20 (0x7f6bb9304d20 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0x7b1990 (0x7f6bef1b1990 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #6: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7f6bef999c7c in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #7: at::mm(at::Tensor const&, at::Tensor const&) + 0x4b (0x7f6bef8eab0b in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #8: <unknown function> + 0x2c2be8f (0x7f6bf162be8f in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x7b1990 (0x7f6bef1b1990 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7f6bef999c7c in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::Tensor::mm(at::Tensor const&) const + 0x4b (0x7f6befa8010b in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #12: <unknown function> + 0x2a6d41b (0x7f6bf146d41b in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #13: torch::autograd::generated::MmBackward::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&) + 0x25f (0x7f6bf1488c3f in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x30d1017 (0x7f6bf1ad1017 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #15: torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&) + 0x1400 (0x7f6bf1acc860 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #16: torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&) + 0x451 (0x7f6bf1acd401 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #17: torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x89 (0x7f6bf1ac5579 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #18: torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x4a (0x7f6bf632a99a in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #19: <unknown function> + 0xc9039 (0x7f6c0b38d039 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/../../../.././libstdc++.so.6)
frame #20: <unknown function> + 0x8d5c2 (0x7f6c12cdd5c2 in /usr/lib/libc.so.6)
frame #21: clone + 0x44 (0x7f6c12d62584 in /usr/lib/libc.so.6)

[03/08 03:20:48] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/08 03:21:13] fastreid INFO: Rank of current process: 0. World size: 1
[03/08 03:21:14] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               None
Pillow                  9.0.1
torchvision             0.7.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision/_C.so
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[03/08 03:21:14] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/08 03:21:14] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/08 03:21:14] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 4
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/08 03:21:14] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/08 03:21:14] fastreid.utils.env INFO: Using a generated random seed 14766766
[03/08 03:21:14] fastreid.engine.defaults INFO: Prepare training set
[03/08 03:21:14] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/08 03:21:14] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/08 03:21:16] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/08 03:21:16] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/08 03:22:31] fastreid INFO: Rank of current process: 0. World size: 1
[03/08 03:22:32] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               None
Pillow                  9.0.1
torchvision             0.7.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision/_C.so
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[03/08 03:22:32] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/08 03:22:32] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/08 03:22:32] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 4
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/08 03:22:32] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/08 03:22:32] fastreid.utils.env INFO: Using a generated random seed 32592883
[03/08 03:22:32] fastreid.engine.defaults INFO: Prepare training set
[03/08 03:22:32] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/08 03:22:32] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/08 03:22:34] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/08 03:22:34] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/08 03:27:10] fastreid INFO: Rank of current process: 0. World size: 1
[03/08 03:27:11] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               None
Pillow                  9.0.1
torchvision             0.7.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision/_C.so
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[03/08 03:27:11] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/08 03:27:11] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/08 03:27:11] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 8
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/08 03:27:11] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/08 03:27:11] fastreid.utils.env INFO: Using a generated random seed 11918346
[03/08 03:27:11] fastreid.engine.defaults INFO: Prepare training set
[03/08 03:27:11] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/08 03:27:11] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/08 03:27:13] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/08 03:27:13] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/08 03:27:25] fastreid INFO: Rank of current process: 0. World size: 1
[03/08 03:27:26] fastreid INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.6.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               None
Pillow                  9.0.1
torchvision             0.7.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision/_C.so
cv2                     4.5.5
----------------------  ----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.5.0 (Git Hash e2ac1fac44c5078ca927cb9b90e1b3066a0b2ed0)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_STATIC_DISPATCH=OFF, 

[03/08 03:27:26] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/08 03:27:26] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/08 03:27:26] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/08 03:27:26] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/08 03:27:26] fastreid.utils.env INFO: Using a generated random seed 26722846
[03/08 03:27:26] fastreid.engine.defaults INFO: Prepare training set
[03/08 03:27:26] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/08 03:27:26] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/08 03:27:28] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/08 03:27:28] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/08 03:27:28] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/08 03:27:28] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/08 03:27:28] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "./fastreid/engine/train_loop.py", line 145, in train
    self.run_step()
  File "./fastreid/engine/defaults.py", line 359, in run_step
    self._trainer.run_step()
  File "./fastreid/engine/train_loop.py", line 347, in run_step
    self.grad_scaler.scale(losses).backward()
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/tensor.py", line 185, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/autograd/__init__.py", line 127, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling `cublasGemmEx( handle, opa, opb, m, n, k, &falpha, a, CUDA_R_16F, lda, b, CUDA_R_16F, ldb, &fbeta, c, CUDA_R_16F, ldc, CUDA_R_32F, CUBLAS_GEMM_DFALT_TENSOR_OP)`
Exception raised from gemm<c10::Half> at /opt/conda/conda-bld/pytorch_1595629427478/work/aten/src/ATen/cuda/CUDABlas.cpp:226 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x4d (0x7fbc9124e77d in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xcda774 (0x7fbc926da774 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #2: at::native::(anonymous namespace)::addmm_out_cuda_impl(at::Tensor&, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar, c10::Scalar) + 0x1074 (0x7fbc93a43bc4 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #3: at::native::mm_cuda(at::Tensor const&, at::Tensor const&) + 0xb3 (0x7fbc93a455c3 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd04d20 (0x7fbc92704d20 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0x7b1990 (0x7fbcc85b1990 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #6: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7fbcc8d99c7c in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #7: at::mm(at::Tensor const&, at::Tensor const&) + 0x4b (0x7fbcc8ceab0b in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #8: <unknown function> + 0x2c2be8f (0x7fbccaa2be8f in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x7b1990 (0x7fbcc85b1990 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7fbcc8d99c7c in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::Tensor::mm(at::Tensor const&) const + 0x4b (0x7fbcc8e8010b in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #12: <unknown function> + 0x2a6d41b (0x7fbcca86d41b in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #13: torch::autograd::generated::MmBackward::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&) + 0x25f (0x7fbcca888c3f in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x30d1017 (0x7fbccaed1017 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #15: torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&) + 0x1400 (0x7fbccaecc860 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #16: torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&) + 0x451 (0x7fbccaecd401 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #17: torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x89 (0x7fbccaec5579 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #18: torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x4a (0x7fbccf72a99a in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #19: <unknown function> + 0xc9039 (0x7fbceb6d7039 in /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/lib/../../../.././libstdc++.so.6)
frame #20: <unknown function> + 0x8d5c2 (0x7fbcec2825c2 in /usr/lib/libc.so.6)
frame #21: clone + 0x44 (0x7fbcec307584 in /usr/lib/libc.so.6)

[03/08 03:27:28] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/08 03:38:31] fastreid INFO: Rank of current process: 0. World size: 1
[03/08 03:38:32] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               None
Pillow                  9.0.1
torchvision             0.11.3 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  /home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision/_C.so
cv2                     4.5.5
----------------------  -----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[03/08 03:38:32] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/08 03:38:32] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/08 03:38:32] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/08 03:38:32] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/08 03:38:32] fastreid.utils.env INFO: Using a generated random seed 32413935
[03/08 03:38:32] fastreid.engine.defaults INFO: Prepare training set
[03/08 03:38:32] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/08 03:38:32] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/08 03:38:35] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/08 03:38:35] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/08 03:38:35] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/08 03:38:35] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/08 03:38:35] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "./fastreid/engine/train_loop.py", line 145, in train
    self.run_step()
  File "./fastreid/engine/defaults.py", line 359, in run_step
    self._trainer.run_step()
  File "./fastreid/engine/train_loop.py", line 347, in run_step
    self.grad_scaler.scale(losses).backward()
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/_tensor.py", line 307, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/autograd/__init__.py", line 156, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
RuntimeError: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling `cublasGemmEx( handle, opa, opb, m, n, k, &falpha, a, CUDA_R_16F, lda, b, CUDA_R_16F, ldb, &fbeta, c, CUDA_R_16F, ldc, CUDA_R_32F, CUBLAS_GEMM_DFALT_TENSOR_OP)`
[03/08 03:38:35] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/10 19:15:24] fastreid INFO: Rank of current process: 0. World size: 1
[03/10 19:15:25] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.10.2 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               /opt/cuda
Pillow                  9.0.1
torchvision             0.11.3 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75
cv2                     4.5.5
----------------------  -----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.2.3 (Git Hash 7336ca9f055cf1bfa13efb658fe15dc9b41f0740)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.10.2, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[03/10 19:15:25] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[03/10 19:15:25] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/10 19:15:25] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/10 19:15:25] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/10 19:15:25] fastreid.utils.env INFO: Using a generated random seed 25446431
[03/10 19:15:25] fastreid.engine.defaults INFO: Prepare training set
[03/10 19:15:25] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/10 19:15:25] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/10 19:15:27] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/10 19:15:27] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/10 19:15:28] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/10 19:15:28] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/10 19:15:28] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "./fastreid/engine/train_loop.py", line 145, in train
    self.run_step()
  File "./fastreid/engine/defaults.py", line 359, in run_step
    self._trainer.run_step()
  File "./fastreid/engine/train_loop.py", line 347, in run_step
    self.grad_scaler.scale(losses).backward()
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/_tensor.py", line 307, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/autograd/__init__.py", line 156, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
RuntimeError: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling `cublasGemmEx( handle, opa, opb, m, n, k, &falpha, a, CUDA_R_16F, lda, b, CUDA_R_16F, ldb, &fbeta, c, CUDA_R_16F, ldc, CUDA_R_32F, CUBLAS_GEMM_DFALT_TENSOR_OP)`
[03/10 19:15:28] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/10 20:08:50] fastreid INFO: Rank of current process: 0. World size: 1
[03/10 20:08:50] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               /opt/cuda
Pillow                  9.0.1
torchvision             0.12.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75, sm_80, sm_86
cv2                     4.5.5
----------------------  -----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[03/10 20:08:50] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/10 20:08:50] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/10 20:08:50] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/10 20:08:50] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/10 20:08:50] fastreid.utils.env INFO: Using a generated random seed 50596882
[03/10 20:08:50] fastreid.engine.defaults INFO: Prepare training set
[03/10 20:08:50] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/10 20:08:50] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/10 20:08:53] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/10 20:08:53] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/10 20:08:53] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/10 20:08:53] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/10 20:08:54] fastreid.utils.events INFO:  eta: 0:00:02  epoch/iter: 0/13  total_loss: 61  loss_cls: 46.97  loss_triplet: 13.96  time: 0.0188  data_time: 0.0018  lr: 3.67e-05  max_mem: 227M
[03/10 20:08:54] fastreid.utils.events INFO:  eta: 0:00:01  epoch/iter: 1/27  total_loss: 58.89  loss_cls: 46.06  loss_triplet: 12.63  time: 0.0168  data_time: 0.0005  lr: 3.89e-05  max_mem: 227M
[03/10 20:08:55] fastreid.utils.events INFO:  eta: 0:00:01  epoch/iter: 2/41  total_loss: 55.68  loss_cls: 44.22  loss_triplet: 10.77  time: 0.0157  data_time: 0.0003  lr: 4.11e-05  max_mem: 227M
[03/10 20:08:55] fastreid.utils.events INFO:  eta: 0:00:01  epoch/iter: 3/55  total_loss: 52.18  loss_cls: 43.17  loss_triplet: 9.235  time: 0.0153  data_time: 0.0003  lr: 4.33e-05  max_mem: 227M
[03/10 20:08:55] fastreid.utils.events INFO:  eta: 0:00:00  epoch/iter: 4/69  total_loss: 49.68  loss_cls: 41.46  loss_triplet: 8.538  time: 0.0150  data_time: 0.0003  lr: 4.56e-05  max_mem: 227M
[03/10 20:08:55] fastreid.utils.events INFO:  eta: 0:00:00  epoch/iter: 5/83  total_loss: 46.91  loss_cls: 39.64  loss_triplet: 7.559  time: 0.0148  data_time: 0.0004  lr: 4.78e-05  max_mem: 227M
[03/10 20:08:56] fastreid.utils.events INFO:  eta: 0:00:00  epoch/iter: 6/97  total_loss: 45.91  loss_cls: 39.08  loss_triplet: 7.307  time: 0.0148  data_time: 0.0004  lr: 5.00e-05  max_mem: 227M
[03/10 20:08:56] fastreid.utils.events INFO:  eta: 0:00:00  epoch/iter: 7/111  total_loss: 44.29  loss_cls: 38.1  loss_triplet: 6.476  time: 0.0147  data_time: 0.0003  lr: 5.22e-05  max_mem: 227M
[03/10 20:08:56] fastreid.utils.events INFO:  eta: 0:00:00  epoch/iter: 8/125  total_loss: 43.09  loss_cls: 37.32  loss_triplet: 6.296  time: 0.0146  data_time: 0.0003  lr: 5.44e-05  max_mem: 227M
[03/10 20:08:57] fastreid.utils.events INFO:  eta: 0:00:00  epoch/iter: 9/139  total_loss: 42.47  loss_cls: 36.14  loss_triplet: 6.151  time: 0.0145  data_time: 0.0003  lr: 5.66e-05  max_mem: 227M
[03/10 20:08:57] fastreid.engine.defaults INFO: Prepare testing set
[03/10 20:08:57] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| query    | 24      | 420        | 1           |
| gallery  | 49      | 708        | 1           |[0m
[03/10 20:08:57] fastreid.evaluation.reid_evaluation INFO: > compiling reid evaluation cython tool
[03/10 20:09:11] fastreid.evaluation.reid_evaluation INFO: >>> done with reid evaluation cython tool. Compilation time: 14.143 seconds
[03/10 20:09:11] fastreid.evaluation.evaluator INFO: Start inference on 1128 images
[03/10 20:09:11] fastreid.evaluation.evaluator INFO: Total inference time: 0:00:00.070154 (0.017539 s / batch per device, on 1 devices)
[03/10 20:09:11] fastreid.evaluation.evaluator INFO: Total inference pure compute time: 0:00:00 (0.002164 s / batch per device, on 1 devices)
[03/10 20:09:11] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "./fastreid/engine/train_loop.py", line 148, in train
    self.after_epoch()
  File "./fastreid/engine/train_loop.py", line 182, in after_epoch
    h.after_epoch()
  File "./fastreid/engine/hooks.py", line 377, in after_epoch
    self._do_eval()
  File "./fastreid/engine/hooks.py", line 351, in _do_eval
    results = self._func()
  File "./fastreid/engine/defaults.py", line 305, in test_and_save_results
    self._last_eval_results = self.test(self.cfg, self.model)
  File "./fastreid/engine/defaults.py", line 441, in test
    results_i = inference_on_dataset(model, data_loader, evaluator, flip_test=cfg.TEST.FLIP.ENABLED)
  File "./fastreid/evaluation/evaluator.py", line 156, in inference_on_dataset
    results = evaluator.evaluate()
  File "./fastreid/evaluation/reid_evaluation.py", line 112, in evaluate
    indexes, query_pids, gallery_pids, query_camids, gallery_camids, use_distmat=False
  File "./fastreid/evaluation/rank.py", line 208, in evaluate_rank
    use_metric_cuhk03, use_distmat)
  File "rank_cy.pyx", line 20, in rank_cy.evaluate_cy
  File "rank_cy.pyx", line 32, in rank_cy.evaluate_cy
  File "rank_cy.pyx", line 242, in rank_cy.eval_market1501_cy
AssertionError: Error: all query identities do not appear in gallery
[03/10 20:09:11] fastreid.engine.hooks INFO: Overall training speed: 138 iterations in 0:00:01 (0.0145 s / it)
[03/10 20:09:11] fastreid.engine.hooks INFO: Total training time: 0:00:17 (0:00:15 on hooks)
[03/10 20:17:37] fastreid INFO: Rank of current process: 0. World size: 1
[03/10 20:17:37] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               /opt/cuda
Pillow                  9.0.1
torchvision             0.12.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75, sm_80, sm_86
cv2                     4.5.5
----------------------  -----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[03/10 20:17:37] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/10 20:17:37] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/10 20:17:37] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/10 20:17:37] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/10 20:17:37] fastreid.utils.env INFO: Using a generated random seed 37766544
[03/10 20:17:37] fastreid.engine.defaults INFO: Prepare training set
[03/10 20:17:37] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 38      | 910        | 1           |[0m
[03/10 20:17:37] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/10 20:17:39] fastreid.engine.defaults INFO: Auto-scaling the num_classes=38
[03/10 20:17:40] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=38, scale=64, margin=0.35)
  )
)
[03/10 20:17:40] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/10 20:17:40] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/10 20:17:42] fastreid.utils.events INFO:  eta: 0:00:01  epoch/iter: 0/13  total_loss: 61.25  loss_cls: 46.33  loss_triplet: 14.79  time: 0.0148  data_time: 0.0025  lr: 3.69e-05  max_mem: 227M
[03/10 20:17:42] fastreid.utils.events INFO:  eta: 0:00:01  epoch/iter: 1/27  total_loss: 57.63  loss_cls: 44.86  loss_triplet: 13.04  time: 0.0144  data_time: 0.0004  lr: 3.91e-05  max_mem: 227M
[03/10 20:17:42] fastreid.utils.events INFO:  eta: 0:00:01  epoch/iter: 2/41  total_loss: 54.14  loss_cls: 43.12  loss_triplet: 10.94  time: 0.0142  data_time: 0.0003  lr: 4.13e-05  max_mem: 227M
[03/10 20:17:42] fastreid.utils.events INFO:  eta: 0:00:01  epoch/iter: 3/55  total_loss: 51.98  loss_cls: 42.52  loss_triplet: 9.417  time: 0.0140  data_time: 0.0003  lr: 4.35e-05  max_mem: 227M
[03/10 20:17:43] fastreid.utils.events INFO:  eta: 0:00:00  epoch/iter: 4/69  total_loss: 49.71  loss_cls: 41.59  loss_triplet: 8.899  time: 0.0139  data_time: 0.0003  lr: 4.57e-05  max_mem: 227M
[03/10 20:17:43] fastreid.utils.events INFO:  eta: 0:00:00  epoch/iter: 5/83  total_loss: 48.54  loss_cls: 40.25  loss_triplet: 8.332  time: 0.0137  data_time: 0.0003  lr: 4.78e-05  max_mem: 227M
[03/10 20:17:43] fastreid.utils.events INFO:  eta: 0:00:00  epoch/iter: 6/97  total_loss: 46.89  loss_cls: 38.64  loss_triplet: 7.894  time: 0.0137  data_time: 0.0002  lr: 5.00e-05  max_mem: 227M
[03/10 20:17:44] fastreid.utils.events INFO:  eta: 0:00:00  epoch/iter: 7/111  total_loss: 45.08  loss_cls: 37.88  loss_triplet: 7.222  time: 0.0136  data_time: 0.0002  lr: 5.22e-05  max_mem: 227M
[03/10 20:17:44] fastreid.utils.events INFO:  eta: 0:00:00  epoch/iter: 8/125  total_loss: 43.51  loss_cls: 36.76  loss_triplet: 6.291  time: 0.0136  data_time: 0.0002  lr: 5.44e-05  max_mem: 227M
[03/10 20:17:44] fastreid.utils.events INFO:  eta: 0:00:00  epoch/iter: 9/139  total_loss: 42.12  loss_cls: 36.42  loss_triplet: 5.816  time: 0.0136  data_time: 0.0003  lr: 5.66e-05  max_mem: 227M
[03/10 20:17:44] fastreid.engine.defaults INFO: Prepare testing set
[03/10 20:17:44] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| query    | 25      | 387        | 1           |
| gallery  | 49      | 708        | 1           |[0m
[03/10 20:17:44] fastreid.evaluation.evaluator INFO: Start inference on 1095 images
[03/10 20:17:45] fastreid.evaluation.evaluator INFO: Total inference time: 0:00:00.080765 (0.020191 s / batch per device, on 1 devices)
[03/10 20:17:45] fastreid.evaluation.evaluator INFO: Total inference pure compute time: 0:00:00 (0.001949 s / batch per device, on 1 devices)
[03/10 20:17:45] fastreid.engine.defaults INFO: Evaluation results for NAIC2021ReidTrain in csv format:
[03/10 20:17:45] fastreid.evaluation.testing INFO: Evaluation results in csv format: 
[36m| Dataset           | Rank-1   | Rank-5   | Rank-10   | mAP   | mINP   | metric   |
|:------------------|:---------|:---------|:----------|:------|:-------|:---------|
| NAIC2021ReidTrain | 100.00   | 100.00   | 100.00    | 32.13 | 10.66  | 66.07    |[0m
[03/10 20:17:45] fastreid.utils.checkpoint INFO: Saving checkpoint to logs/NAIC2021Reid/sbs_mlp2x/model_best.pth
[03/10 20:17:45] fastreid.utils.checkpoint INFO: Saving checkpoint to logs/NAIC2021Reid/sbs_mlp2x/model_final.pth
[03/10 20:17:45] fastreid.utils.events INFO:  eta: 0:00:00  epoch/iter: 9/139  total_loss: 42.12  loss_cls: 36.42  loss_triplet: 5.816  time: 0.0136  data_time: 0.0003  lr: 5.66e-05  max_mem: 227M
[03/10 20:17:45] fastreid.engine.hooks INFO: Overall training speed: 138 iterations in 0:00:01 (0.0136 s / it)
[03/10 20:17:45] fastreid.engine.hooks INFO: Total training time: 0:00:03 (0:00:01 on hooks)
[03/10 21:28:34] fastreid INFO: Rank of current process: 0. World size: 1
[03/10 21:28:35] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               /opt/cuda
Pillow                  9.0.1
torchvision             0.12.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75, sm_80, sm_86
cv2                     4.5.5
----------------------  -----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[03/10 21:28:35] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/10 21:28:35] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/10 21:28:35] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/10 21:28:35] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/10 21:28:35] fastreid.utils.env INFO: Using a generated random seed 35398584
[03/10 21:28:35] fastreid.engine.defaults INFO: Prepare training set
[03/10 21:28:35] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 14883   | 200000     | 1           |[0m
[03/10 21:28:35] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/10 21:28:39] fastreid.engine.defaults INFO: Auto-scaling the num_classes=14883
[03/10 21:28:39] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=14883, scale=64, margin=0.35)
  )
)
[03/10 21:30:55] fastreid INFO: Rank of current process: 0. World size: 1
[03/10 21:30:56] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               /opt/cuda
Pillow                  9.0.1
torchvision             0.12.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75, sm_80, sm_86
cv2                     4.5.5
----------------------  -----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[03/10 21:30:56] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/10 21:30:56] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/10 21:30:56] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/10 21:30:56] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/10 21:30:56] fastreid.utils.env INFO: Using a generated random seed 56709104
[03/10 21:30:56] fastreid.engine.defaults INFO: Prepare training set
[03/10 21:30:57] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 14883   | 200000     | 1           |[0m
[03/10 21:30:57] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/10 21:31:00] fastreid.engine.defaults INFO: Auto-scaling the num_classes=14883
[03/10 21:31:00] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=14883, scale=64, margin=0.35)
  )
)
[03/10 21:39:13] fastreid INFO: Rank of current process: 0. World size: 1
[03/10 21:39:14] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               /opt/cuda
Pillow                  9.0.1
torchvision             0.12.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75, sm_80, sm_86
cv2                     4.5.5
----------------------  -----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[03/10 21:39:14] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/10 21:39:14] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/10 21:39:14] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/10 21:39:14] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/10 21:39:14] fastreid.utils.env INFO: Using a generated random seed 14670518
[03/10 21:39:14] fastreid.engine.defaults INFO: Prepare training set
[03/10 21:39:15] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 14883   | 200000     | 1           |[0m
[03/10 21:39:15] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/10 21:39:19] fastreid.engine.defaults INFO: Auto-scaling the num_classes=14883
[03/10 21:39:19] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=14883, scale=64, margin=0.35)
  )
)
[03/10 21:39:20] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/10 21:39:20] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/10 21:39:22] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "./fastreid/engine/train_loop.py", line 145, in train
    self.run_step()
  File "./fastreid/engine/defaults.py", line 359, in run_step
    self._trainer.run_step()
  File "./fastreid/engine/train_loop.py", line 343, in run_step
    loss_dict = self.model(data)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "./fastreid/modeling/meta_arch/baseline.py", line 101, in forward
    features = self.backbone(images)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "./fastreid/modeling/backbones/mlp.py", line 16, in forward
    x = self.fc(x)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/nn/modules/linear.py", line 103, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: CUDA error: CUBLAS_STATUS_NOT_INITIALIZED when calling `cublasCreate(handle)`
[03/10 21:39:22] fastreid.engine.hooks INFO: Total training time: 0:00:02 (0:00:00 on hooks)
[03/10 21:41:31] fastreid INFO: Rank of current process: 0. World size: 1
[03/10 21:41:32] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               /opt/cuda
Pillow                  9.0.1
torchvision             0.12.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75, sm_80, sm_86
cv2                     4.5.5
----------------------  -----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[03/10 21:41:32] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/10 21:41:32] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/10 21:41:32] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/10 21:41:32] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/10 21:41:32] fastreid.utils.env INFO: Using a generated random seed 32142741
[03/10 21:41:32] fastreid.engine.defaults INFO: Prepare training set
[03/10 21:41:32] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 14883   | 200000     | 1           |[0m
[03/10 21:41:32] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/10 21:41:35] fastreid.engine.defaults INFO: Auto-scaling the num_classes=14883
[03/10 21:41:35] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=14883, scale=64, margin=0.35)
  )
)
[03/10 21:41:35] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/10 21:41:35] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/10 21:41:58] fastreid.utils.events INFO:  eta: 0:39:57  epoch/iter: 0/199  total_loss: 59.61  loss_cls: 53.23  loss_triplet: 6.245  time: 0.0782  data_time: 0.0040  lr: 6.59e-05  max_mem: 1189M
[03/10 21:42:20] fastreid.utils.events INFO:  eta: 0:40:53  epoch/iter: 0/399  total_loss: 58.4  loss_cls: 53.22  loss_triplet: 5.073  time: 0.0791  data_time: 0.0029  lr: 9.74e-05  max_mem: 1189M
[03/10 21:42:43] fastreid.utils.events INFO:  eta: 0:40:46  epoch/iter: 0/599  total_loss: 58.14  loss_cls: 53.34  loss_triplet: 4.671  time: 0.0796  data_time: 0.0037  lr: 1.29e-04  max_mem: 1189M
[03/10 21:43:06] fastreid.utils.events INFO:  eta: 0:40:43  epoch/iter: 0/799  total_loss: 58.06  loss_cls: 53.46  loss_triplet: 4.604  time: 0.0803  data_time: 0.0027  lr: 1.60e-04  max_mem: 1189M
[03/10 21:43:28] fastreid.utils.events INFO:  eta: 0:40:48  epoch/iter: 0/999  total_loss: 58.97  loss_cls: 53.49  loss_triplet: 5.437  time: 0.0807  data_time: 0.0030  lr: 1.92e-04  max_mem: 1189M
[03/10 21:43:51] fastreid.utils.events INFO:  eta: 0:40:56  epoch/iter: 0/1199  total_loss: 59.24  loss_cls: 53.52  loss_triplet: 5.798  time: 0.0809  data_time: 0.0028  lr: 2.23e-04  max_mem: 1189M
[03/10 21:44:14] fastreid.utils.events INFO:  eta: 0:40:48  epoch/iter: 0/1399  total_loss: 59.81  loss_cls: 53.65  loss_triplet: 6.074  time: 0.0809  data_time: 0.0024  lr: 2.55e-04  max_mem: 1189M
[03/10 21:44:36] fastreid.utils.events INFO:  eta: 0:40:29  epoch/iter: 0/1599  total_loss: 60.49  loss_cls: 53.77  loss_triplet: 6.331  time: 0.0810  data_time: 0.0021  lr: 2.86e-04  max_mem: 1189M
[03/10 21:44:59] fastreid.utils.events INFO:  eta: 0:40:04  epoch/iter: 0/1799  total_loss: 60.34  loss_cls: 53.98  loss_triplet: 6.251  time: 0.0810  data_time: 0.0020  lr: 3.18e-04  max_mem: 1189M
[03/10 21:45:21] fastreid.utils.events INFO:  eta: 0:39:42  epoch/iter: 0/1999  total_loss: 60.38  loss_cls: 53.98  loss_triplet: 6.505  time: 0.0810  data_time: 0.0023  lr: 3.49e-04  max_mem: 1189M
[03/10 21:45:44] fastreid.utils.events INFO:  eta: 0:39:29  epoch/iter: 0/2199  total_loss: 60.92  loss_cls: 54.03  loss_triplet: 6.73  time: 0.0838  data_time: 0.0021  lr: 3.50e-04  max_mem: 1189M
[03/10 21:46:06] fastreid.utils.events INFO:  eta: 0:39:18  epoch/iter: 0/2399  total_loss: 60.37  loss_cls: 54.06  loss_triplet: 6.55  time: 0.0861  data_time: 0.0016  lr: 3.50e-04  max_mem: 1189M
[03/10 21:46:28] fastreid.utils.events INFO:  eta: 0:52:47  epoch/iter: 0/2599  total_loss: 60.02  loss_cls: 54.15  loss_triplet: 6.045  time: 0.0881  data_time: 0.0013  lr: 3.50e-04  max_mem: 1189M
[03/10 21:46:51] fastreid.utils.events INFO:  eta: 0:52:49  epoch/iter: 0/2799  total_loss: 60.16  loss_cls: 54.12  loss_triplet: 6.056  time: 0.0897  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/10 21:47:13] fastreid.utils.events INFO:  eta: 0:52:32  epoch/iter: 0/2999  total_loss: 59.58  loss_cls: 54.06  loss_triplet: 5.551  time: 0.0912  data_time: 0.0016  lr: 3.50e-04  max_mem: 1189M
[03/10 21:47:27] fastreid.utils.events INFO:  eta: 0:52:15  epoch/iter: 0/3124  total_loss: 59.27  loss_cls: 54.02  loss_triplet: 5.671  time: 0.0920  data_time: 0.0016  lr: 3.50e-04  max_mem: 1189M
[03/10 21:47:35] fastreid.utils.events INFO:  eta: 0:52:05  epoch/iter: 1/3199  total_loss: 59.31  loss_cls: 53.92  loss_triplet: 5.662  time: 0.0924  data_time: 0.0008  lr: 3.50e-04  max_mem: 1189M
[03/10 21:47:57] fastreid.utils.events INFO:  eta: 0:51:34  epoch/iter: 1/3399  total_loss: 59.26  loss_cls: 53.83  loss_triplet: 5.58  time: 0.0935  data_time: 0.0010  lr: 3.50e-04  max_mem: 1189M
[03/10 21:48:19] fastreid.utils.events INFO:  eta: 0:50:58  epoch/iter: 1/3599  total_loss: 58.26  loss_cls: 53.68  loss_triplet: 5.562  time: 0.0944  data_time: 0.0006  lr: 3.50e-04  max_mem: 1189M
[03/10 21:48:41] fastreid.utils.events INFO:  eta: 0:50:29  epoch/iter: 1/3799  total_loss: 57.76  loss_cls: 53.1  loss_triplet: 5.444  time: 0.0952  data_time: 0.0005  lr: 3.50e-04  max_mem: 1189M
[03/10 21:49:03] fastreid.utils.events INFO:  eta: 0:49:56  epoch/iter: 1/3999  total_loss: 57.1  loss_cls: 51.03  loss_triplet: 6.144  time: 0.0959  data_time: 0.0004  lr: 3.50e-04  max_mem: 1189M
[03/10 21:49:26] fastreid.utils.events INFO:  eta: 0:49:32  epoch/iter: 1/4199  total_loss: 51.82  loss_cls: 46.57  loss_triplet: 5.422  time: 0.0967  data_time: 0.0044  lr: 3.50e-04  max_mem: 1189M
[03/10 21:49:49] fastreid.utils.events INFO:  eta: 0:49:12  epoch/iter: 1/4399  total_loss: 51.03  loss_cls: 46.21  loss_triplet: 4.354  time: 0.0975  data_time: 0.0034  lr: 3.50e-04  max_mem: 1189M
[03/10 21:50:12] fastreid.utils.events INFO:  eta: 0:49:46  epoch/iter: 1/4599  total_loss: 49.82  loss_cls: 45.61  loss_triplet: 4.064  time: 0.0983  data_time: 0.0025  lr: 3.50e-04  max_mem: 1189M
[03/10 21:50:34] fastreid.utils.events INFO:  eta: 0:49:46  epoch/iter: 1/4799  total_loss: 49.45  loss_cls: 45.37  loss_triplet: 4.022  time: 0.0989  data_time: 0.0035  lr: 3.50e-04  max_mem: 1189M
[03/10 21:50:57] fastreid.utils.events INFO:  eta: 0:49:26  epoch/iter: 1/4999  total_loss: 49.57  loss_cls: 45.76  loss_triplet: 4.088  time: 0.0994  data_time: 0.0024  lr: 3.50e-04  max_mem: 1189M
[03/10 21:51:19] fastreid.utils.events INFO:  eta: 0:48:47  epoch/iter: 1/5199  total_loss: 49.31  loss_cls: 44.86  loss_triplet: 4.133  time: 0.0999  data_time: 0.0027  lr: 3.50e-04  max_mem: 1189M
[03/10 21:51:41] fastreid.utils.events INFO:  eta: 0:48:14  epoch/iter: 1/5399  total_loss: 48.76  loss_cls: 45.25  loss_triplet: 3.609  time: 0.1003  data_time: 0.0026  lr: 3.50e-04  max_mem: 1189M
[03/10 21:52:03] fastreid.utils.events INFO:  eta: 0:47:42  epoch/iter: 1/5599  total_loss: 49.07  loss_cls: 45.29  loss_triplet: 3.816  time: 0.1007  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/10 21:52:26] fastreid.utils.events INFO:  eta: 0:47:14  epoch/iter: 1/5799  total_loss: 49.45  loss_cls: 45.53  loss_triplet: 3.834  time: 0.1011  data_time: 0.0021  lr: 3.50e-04  max_mem: 1189M
[03/10 21:52:48] fastreid.utils.events INFO:  eta: 0:46:46  epoch/iter: 1/5999  total_loss: 49.13  loss_cls: 45.53  loss_triplet: 3.744  time: 0.1014  data_time: 0.0017  lr: 3.50e-04  max_mem: 1189M
[03/10 21:53:10] fastreid.utils.events INFO:  eta: 0:46:16  epoch/iter: 1/6199  total_loss: 49.07  loss_cls: 45.6  loss_triplet: 3.751  time: 0.1017  data_time: 0.0016  lr: 3.50e-04  max_mem: 1189M
[03/10 21:53:15] fastreid.utils.events INFO:  eta: 0:46:08  epoch/iter: 1/6249  total_loss: 49.07  loss_cls: 45.58  loss_triplet: 3.591  time: 0.1017  data_time: 0.0015  lr: 3.50e-04  max_mem: 1189M
[03/10 21:53:32] fastreid.utils.events INFO:  eta: 0:45:45  epoch/iter: 2/6399  total_loss: 48.56  loss_cls: 45.21  loss_triplet: 3.433  time: 0.1019  data_time: 0.0016  lr: 3.50e-04  max_mem: 1189M
[03/10 21:53:54] fastreid.utils.events INFO:  eta: 0:45:18  epoch/iter: 2/6599  total_loss: 48.68  loss_cls: 45.18  loss_triplet: 3.256  time: 0.1022  data_time: 0.0013  lr: 3.50e-04  max_mem: 1189M
[03/10 21:54:16] fastreid.utils.events INFO:  eta: 0:44:52  epoch/iter: 2/6799  total_loss: 49.22  loss_cls: 45.73  loss_triplet: 3.502  time: 0.1024  data_time: 0.0010  lr: 3.50e-04  max_mem: 1189M
[03/10 21:54:38] fastreid.utils.events INFO:  eta: 0:44:27  epoch/iter: 2/6999  total_loss: 49.03  loss_cls: 45.21  loss_triplet: 3.627  time: 0.1026  data_time: 0.0010  lr: 3.50e-04  max_mem: 1189M
[03/10 21:54:59] fastreid.utils.events INFO:  eta: 0:44:02  epoch/iter: 2/7199  total_loss: 48.88  loss_cls: 45.41  loss_triplet: 3.476  time: 0.1028  data_time: 0.0009  lr: 3.50e-04  max_mem: 1189M
[03/10 21:55:21] fastreid.utils.events INFO:  eta: 0:43:36  epoch/iter: 2/7399  total_loss: 47.34  loss_cls: 44.4  loss_triplet: 3.271  time: 0.1029  data_time: 0.0005  lr: 3.50e-04  max_mem: 1189M
[03/10 21:55:43] fastreid.utils.events INFO:  eta: 0:43:09  epoch/iter: 2/7599  total_loss: 48.59  loss_cls: 45.05  loss_triplet: 3.651  time: 0.1031  data_time: 0.0008  lr: 3.50e-04  max_mem: 1189M
[03/10 21:56:05] fastreid.utils.events INFO:  eta: 0:42:46  epoch/iter: 2/7799  total_loss: 47.71  loss_cls: 43.96  loss_triplet: 3.343  time: 0.1033  data_time: 0.0005  lr: 3.50e-04  max_mem: 1189M
[03/10 21:56:27] fastreid.utils.events INFO:  eta: 0:42:21  epoch/iter: 2/7999  total_loss: 46.76  loss_cls: 43.28  loss_triplet: 3.237  time: 0.1034  data_time: 0.0003  lr: 3.50e-04  max_mem: 1189M
[03/10 21:56:49] fastreid.utils.events INFO:  eta: 0:41:53  epoch/iter: 2/8199  total_loss: 43.63  loss_cls: 39.98  loss_triplet: 3.787  time: 0.1035  data_time: 0.0003  lr: 3.50e-04  max_mem: 1189M
[03/10 21:57:11] fastreid.utils.events INFO:  eta: 0:41:34  epoch/iter: 2/8399  total_loss: 37.09  loss_cls: 34.23  loss_triplet: 2.949  time: 0.1037  data_time: 0.0026  lr: 3.50e-04  max_mem: 1189M
[03/10 21:57:33] fastreid.utils.events INFO:  eta: 0:41:18  epoch/iter: 2/8599  total_loss: 36.98  loss_cls: 34.63  loss_triplet: 2.4  time: 0.1039  data_time: 0.0030  lr: 3.50e-04  max_mem: 1189M
[03/10 21:57:56] fastreid.utils.events INFO:  eta: 0:41:30  epoch/iter: 2/8799  total_loss: 36.53  loss_cls: 34.42  loss_triplet: 2.485  time: 0.1041  data_time: 0.0029  lr: 3.50e-04  max_mem: 1189M
[03/10 21:58:18] fastreid.utils.events INFO:  eta: 0:41:27  epoch/iter: 2/8999  total_loss: 36.4  loss_cls: 34.18  loss_triplet: 2.466  time: 0.1043  data_time: 0.0029  lr: 3.50e-04  max_mem: 1189M
[03/10 21:58:40] fastreid.utils.events INFO:  eta: 0:41:06  epoch/iter: 2/9199  total_loss: 38.31  loss_cls: 35.64  loss_triplet: 2.736  time: 0.1044  data_time: 0.0024  lr: 3.50e-04  max_mem: 1189M
[03/10 21:59:00] fastreid.utils.events INFO:  eta: 0:40:43  epoch/iter: 2/9374  total_loss: 36.65  loss_cls: 34.35  loss_triplet: 2.202  time: 0.1046  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/10 21:59:03] fastreid.utils.events INFO:  eta: 0:40:40  epoch/iter: 3/9399  total_loss: 36.37  loss_cls: 34.11  loss_triplet: 2.247  time: 0.1046  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/10 21:59:25] fastreid.utils.events INFO:  eta: 0:40:13  epoch/iter: 3/9599  total_loss: 37.95  loss_cls: 35.21  loss_triplet: 2.483  time: 0.1047  data_time: 0.0021  lr: 3.50e-04  max_mem: 1189M
[03/10 21:59:47] fastreid.utils.events INFO:  eta: 0:39:46  epoch/iter: 3/9799  total_loss: 37.27  loss_cls: 35.06  loss_triplet: 2.24  time: 0.1048  data_time: 0.0019  lr: 3.50e-04  max_mem: 1189M
[03/10 22:00:09] fastreid.utils.events INFO:  eta: 0:39:19  epoch/iter: 3/9999  total_loss: 37.6  loss_cls: 35.19  loss_triplet: 2.494  time: 0.1049  data_time: 0.0018  lr: 3.50e-04  max_mem: 1189M
[03/10 22:00:31] fastreid.utils.events INFO:  eta: 0:38:52  epoch/iter: 3/10199  total_loss: 37.1  loss_cls: 35.02  loss_triplet: 2.129  time: 0.1050  data_time: 0.0016  lr: 3.50e-04  max_mem: 1189M
[03/10 22:00:53] fastreid.utils.events INFO:  eta: 0:38:25  epoch/iter: 3/10399  total_loss: 37.2  loss_cls: 35  loss_triplet: 2.283  time: 0.1051  data_time: 0.0013  lr: 3.50e-04  max_mem: 1189M
[03/10 22:01:15] fastreid.utils.events INFO:  eta: 0:37:59  epoch/iter: 3/10599  total_loss: 37.45  loss_cls: 34.76  loss_triplet: 2.425  time: 0.1052  data_time: 0.0016  lr: 3.50e-04  max_mem: 1189M
[03/10 22:01:37] fastreid.utils.events INFO:  eta: 0:37:33  epoch/iter: 3/10799  total_loss: 37.63  loss_cls: 35.31  loss_triplet: 2.375  time: 0.1053  data_time: 0.0017  lr: 3.50e-04  max_mem: 1189M
[03/10 22:01:59] fastreid.utils.events INFO:  eta: 0:37:09  epoch/iter: 3/10999  total_loss: 36.74  loss_cls: 34.89  loss_triplet: 2.113  time: 0.1054  data_time: 0.0013  lr: 3.50e-04  max_mem: 1189M
[03/10 22:02:21] fastreid.utils.events INFO:  eta: 0:36:44  epoch/iter: 3/11199  total_loss: 36.87  loss_cls: 34.73  loss_triplet: 2.202  time: 0.1055  data_time: 0.0009  lr: 3.50e-04  max_mem: 1189M
[03/10 22:02:43] fastreid.utils.events INFO:  eta: 0:36:16  epoch/iter: 3/11399  total_loss: 37.34  loss_cls: 34.87  loss_triplet: 2.333  time: 0.1055  data_time: 0.0008  lr: 3.50e-04  max_mem: 1189M
[03/10 22:03:04] fastreid.utils.events INFO:  eta: 0:35:45  epoch/iter: 3/11599  total_loss: 37.68  loss_cls: 35.43  loss_triplet: 2.156  time: 0.1056  data_time: 0.0006  lr: 3.50e-04  max_mem: 1189M
[03/10 22:03:26] fastreid.utils.events INFO:  eta: 0:35:19  epoch/iter: 3/11799  total_loss: 36.93  loss_cls: 34.85  loss_triplet: 2.259  time: 0.1056  data_time: 0.0004  lr: 3.50e-04  max_mem: 1189M
[03/10 22:03:48] fastreid.utils.events INFO:  eta: 0:34:51  epoch/iter: 3/11999  total_loss: 37.58  loss_cls: 35.14  loss_triplet: 2.339  time: 0.1057  data_time: 0.0004  lr: 3.50e-04  max_mem: 1189M
[03/10 22:04:09] fastreid.utils.events INFO:  eta: 0:34:25  epoch/iter: 3/12199  total_loss: 36.66  loss_cls: 34.69  loss_triplet: 2.199  time: 0.1057  data_time: 0.0003  lr: 3.50e-04  max_mem: 1189M
[03/10 22:04:31] fastreid.utils.events INFO:  eta: 0:34:02  epoch/iter: 3/12399  total_loss: 33.54  loss_cls: 31.05  loss_triplet: 2.24  time: 0.1058  data_time: 0.0038  lr: 3.50e-04  max_mem: 1189M
[03/10 22:04:42] fastreid.utils.events INFO:  eta: 0:33:52  epoch/iter: 3/12499  total_loss: 31.7  loss_cls: 29.9  loss_triplet: 1.95  time: 0.1058  data_time: 0.0027  lr: 3.50e-04  max_mem: 1189M
[03/10 22:04:54] fastreid.utils.events INFO:  eta: 0:33:42  epoch/iter: 4/12599  total_loss: 31.7  loss_cls: 30.01  loss_triplet: 1.669  time: 0.1059  data_time: 0.0024  lr: 3.50e-04  max_mem: 1189M
[03/10 22:05:16] fastreid.utils.events INFO:  eta: 0:33:23  epoch/iter: 4/12799  total_loss: 32.26  loss_cls: 30.39  loss_triplet: 1.767  time: 0.1059  data_time: 0.0028  lr: 3.50e-04  max_mem: 1189M
[03/10 22:05:38] fastreid.utils.events INFO:  eta: 0:33:51  epoch/iter: 4/12999  total_loss: 32.59  loss_cls: 30.59  loss_triplet: 1.874  time: 0.1060  data_time: 0.0027  lr: 3.50e-04  max_mem: 1189M
[03/10 22:06:00] fastreid.utils.events INFO:  eta: 0:33:30  epoch/iter: 4/13199  total_loss: 32.67  loss_cls: 30.68  loss_triplet: 1.747  time: 0.1061  data_time: 0.0026  lr: 3.50e-04  max_mem: 1189M
[03/10 22:06:22] fastreid.utils.events INFO:  eta: 0:33:07  epoch/iter: 4/13399  total_loss: 32.29  loss_cls: 30.73  loss_triplet: 1.72  time: 0.1062  data_time: 0.0025  lr: 3.50e-04  max_mem: 1189M
[03/10 22:06:45] fastreid.utils.events INFO:  eta: 0:32:43  epoch/iter: 4/13599  total_loss: 31.97  loss_cls: 30.38  loss_triplet: 1.572  time: 0.1062  data_time: 0.0022  lr: 3.50e-04  max_mem: 1189M
[03/10 22:07:07] fastreid.utils.events INFO:  eta: 0:32:19  epoch/iter: 4/13799  total_loss: 33.12  loss_cls: 31.42  loss_triplet: 1.694  time: 0.1063  data_time: 0.0021  lr: 3.50e-04  max_mem: 1189M
[03/10 22:07:29] fastreid.utils.events INFO:  eta: 0:31:55  epoch/iter: 4/13999  total_loss: 32.54  loss_cls: 31.11  loss_triplet: 1.612  time: 0.1064  data_time: 0.0018  lr: 3.50e-04  max_mem: 1189M
[03/10 22:07:51] fastreid.utils.events INFO:  eta: 0:31:31  epoch/iter: 4/14199  total_loss: 32.79  loss_cls: 31.01  loss_triplet: 1.675  time: 0.1064  data_time: 0.0019  lr: 3.50e-04  max_mem: 1189M
[03/10 22:08:13] fastreid.utils.events INFO:  eta: 0:31:06  epoch/iter: 4/14399  total_loss: 33.1  loss_cls: 31.48  loss_triplet: 1.504  time: 0.1065  data_time: 0.0016  lr: 3.50e-04  max_mem: 1189M
[03/10 22:08:35] fastreid.utils.events INFO:  eta: 0:30:41  epoch/iter: 4/14599  total_loss: 32.77  loss_cls: 31.13  loss_triplet: 1.571  time: 0.1065  data_time: 0.0013  lr: 3.50e-04  max_mem: 1189M
[03/10 22:08:57] fastreid.utils.events INFO:  eta: 0:30:17  epoch/iter: 4/14799  total_loss: 33.25  loss_cls: 31.65  loss_triplet: 1.628  time: 0.1066  data_time: 0.0011  lr: 3.50e-04  max_mem: 1189M
[03/10 22:09:19] fastreid.utils.events INFO:  eta: 0:29:51  epoch/iter: 4/14999  total_loss: 33.82  loss_cls: 31.73  loss_triplet: 1.548  time: 0.1066  data_time: 0.0010  lr: 3.50e-04  max_mem: 1189M
[03/10 22:09:41] fastreid.utils.events INFO:  eta: 0:29:23  epoch/iter: 4/15199  total_loss: 33.47  loss_cls: 31.96  loss_triplet: 1.583  time: 0.1067  data_time: 0.0009  lr: 3.50e-04  max_mem: 1189M
[03/10 22:10:03] fastreid.utils.events INFO:  eta: 0:28:55  epoch/iter: 4/15399  total_loss: 33.73  loss_cls: 32.21  loss_triplet: 1.582  time: 0.1067  data_time: 0.0008  lr: 3.50e-04  max_mem: 1189M
[03/10 22:10:25] fastreid.utils.events INFO:  eta: 0:28:30  epoch/iter: 4/15599  total_loss: 33.87  loss_cls: 32.14  loss_triplet: 1.559  time: 0.1067  data_time: 0.0006  lr: 3.50e-04  max_mem: 1189M
[03/10 22:10:27] fastreid.utils.events INFO:  eta: 0:28:26  epoch/iter: 4/15624  total_loss: 33.99  loss_cls: 32.2  loss_triplet: 1.551  time: 0.1067  data_time: 0.0006  lr: 3.50e-04  max_mem: 1189M
[03/10 22:10:46] fastreid.utils.events INFO:  eta: 0:28:04  epoch/iter: 5/15799  total_loss: 33.52  loss_cls: 32.13  loss_triplet: 1.535  time: 0.1067  data_time: 0.0006  lr: 3.50e-04  max_mem: 1189M
[03/10 22:11:08] fastreid.utils.events INFO:  eta: 0:27:39  epoch/iter: 5/15999  total_loss: 33.28  loss_cls: 31.94  loss_triplet: 1.55  time: 0.1068  data_time: 0.0004  lr: 3.50e-04  max_mem: 1189M
[03/10 22:11:30] fastreid.utils.events INFO:  eta: 0:27:15  epoch/iter: 5/16199  total_loss: 33.53  loss_cls: 32.13  loss_triplet: 1.504  time: 0.1068  data_time: 0.0003  lr: 3.50e-04  max_mem: 1189M
[03/10 22:11:51] fastreid.utils.events INFO:  eta: 0:26:51  epoch/iter: 5/16399  total_loss: 32.32  loss_cls: 30.9  loss_triplet: 1.698  time: 0.1068  data_time: 0.0004  lr: 3.50e-04  max_mem: 1189M
[03/10 22:12:14] fastreid.utils.events INFO:  eta: 0:26:30  epoch/iter: 5/16599  total_loss: 29.58  loss_cls: 28.24  loss_triplet: 1.392  time: 0.1068  data_time: 0.0026  lr: 3.50e-04  max_mem: 1189M
[03/10 22:12:36] fastreid.utils.events INFO:  eta: 0:26:10  epoch/iter: 5/16799  total_loss: 29.85  loss_cls: 28.4  loss_triplet: 1.216  time: 0.1069  data_time: 0.0024  lr: 3.50e-04  max_mem: 1189M
[03/10 22:12:58] fastreid.utils.events INFO:  eta: 0:26:22  epoch/iter: 5/16999  total_loss: 29.96  loss_cls: 28.5  loss_triplet: 1.312  time: 0.1070  data_time: 0.0029  lr: 3.50e-04  max_mem: 1189M
[03/10 22:13:20] fastreid.utils.events INFO:  eta: 0:26:04  epoch/iter: 5/17199  total_loss: 31.15  loss_cls: 29.57  loss_triplet: 1.341  time: 0.1070  data_time: 0.0031  lr: 3.50e-04  max_mem: 1189M
[03/10 22:13:43] fastreid.utils.events INFO:  eta: 0:25:42  epoch/iter: 5/17399  total_loss: 30.21  loss_cls: 28.86  loss_triplet: 1.26  time: 0.1070  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/10 22:14:05] fastreid.utils.events INFO:  eta: 0:25:18  epoch/iter: 5/17599  total_loss: 31.36  loss_cls: 30.1  loss_triplet: 1.293  time: 0.1071  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/10 22:14:27] fastreid.utils.events INFO:  eta: 0:24:53  epoch/iter: 5/17799  total_loss: 31.16  loss_cls: 30.07  loss_triplet: 1.29  time: 0.1071  data_time: 0.0018  lr: 3.50e-04  max_mem: 1189M
[03/10 22:14:49] fastreid.utils.events INFO:  eta: 0:24:29  epoch/iter: 5/17999  total_loss: 31.08  loss_cls: 29.85  loss_triplet: 1.226  time: 0.1072  data_time: 0.0021  lr: 3.50e-04  max_mem: 1189M
[03/10 22:15:11] fastreid.utils.events INFO:  eta: 0:24:04  epoch/iter: 5/18199  total_loss: 31.28  loss_cls: 29.87  loss_triplet: 1.28  time: 0.1072  data_time: 0.0014  lr: 3.50e-04  max_mem: 1189M
[03/10 22:15:33] fastreid.utils.events INFO:  eta: 0:23:39  epoch/iter: 5/18399  total_loss: 31.9  loss_cls: 30.45  loss_triplet: 1.283  time: 0.1072  data_time: 0.0016  lr: 3.50e-04  max_mem: 1189M
[03/10 22:15:55] fastreid.utils.events INFO:  eta: 0:23:15  epoch/iter: 5/18599  total_loss: 32  loss_cls: 30.8  loss_triplet: 1.324  time: 0.1073  data_time: 0.0018  lr: 3.50e-04  max_mem: 1189M
[03/10 22:16:11] fastreid.utils.events INFO:  eta: 0:22:56  epoch/iter: 5/18749  total_loss: 31.73  loss_cls: 30.77  loss_triplet: 1.244  time: 0.1073  data_time: 0.0012  lr: 3.50e-04  max_mem: 1189M
[03/10 22:16:17] fastreid.utils.events INFO:  eta: 0:22:51  epoch/iter: 6/18799  total_loss: 31.85  loss_cls: 30.78  loss_triplet: 1.25  time: 0.1073  data_time: 0.0016  lr: 3.50e-04  max_mem: 1189M
[03/10 22:16:39] fastreid.utils.events INFO:  eta: 0:22:27  epoch/iter: 6/18999  total_loss: 32.23  loss_cls: 30.76  loss_triplet: 1.246  time: 0.1073  data_time: 0.0015  lr: 3.50e-04  max_mem: 1189M
[03/10 22:17:01] fastreid.utils.events INFO:  eta: 0:22:05  epoch/iter: 6/19199  total_loss: 32.38  loss_cls: 31.07  loss_triplet: 1.265  time: 0.1073  data_time: 0.0011  lr: 3.50e-04  max_mem: 1189M
[03/10 22:17:23] fastreid.utils.events INFO:  eta: 0:21:41  epoch/iter: 6/19399  total_loss: 33.11  loss_cls: 31.86  loss_triplet: 1.33  time: 0.1073  data_time: 0.0011  lr: 3.50e-04  max_mem: 1189M
[03/10 22:17:45] fastreid.utils.events INFO:  eta: 0:21:15  epoch/iter: 6/19599  total_loss: 33.04  loss_cls: 31.7  loss_triplet: 1.17  time: 0.1074  data_time: 0.0010  lr: 3.50e-04  max_mem: 1189M
[03/10 22:18:06] fastreid.utils.events INFO:  eta: 0:20:51  epoch/iter: 6/19799  total_loss: 32.94  loss_cls: 31.69  loss_triplet: 1.173  time: 0.1074  data_time: 0.0007  lr: 3.50e-04  max_mem: 1189M
[03/10 22:18:28] fastreid.utils.events INFO:  eta: 0:20:26  epoch/iter: 6/19999  total_loss: 33.11  loss_cls: 31.94  loss_triplet: 1.247  time: 0.1074  data_time: 0.0006  lr: 3.50e-04  max_mem: 1189M
[03/10 22:18:50] fastreid.utils.events INFO:  eta: 0:20:01  epoch/iter: 6/20199  total_loss: 33.51  loss_cls: 32.44  loss_triplet: 1.26  time: 0.1074  data_time: 0.0004  lr: 3.50e-04  max_mem: 1189M
[03/10 22:19:11] fastreid.utils.events INFO:  eta: 0:19:37  epoch/iter: 6/20399  total_loss: 32.82  loss_cls: 31.57  loss_triplet: 1.282  time: 0.1074  data_time: 0.0003  lr: 3.50e-04  max_mem: 1189M
[03/10 22:19:33] fastreid.utils.events INFO:  eta: 0:19:14  epoch/iter: 6/20599  total_loss: 29.76  loss_cls: 28.78  loss_triplet: 1.275  time: 0.1074  data_time: 0.0029  lr: 3.50e-04  max_mem: 1189M
[03/10 22:19:56] fastreid.utils.events INFO:  eta: 0:18:53  epoch/iter: 6/20799  total_loss: 28.66  loss_cls: 27.81  loss_triplet: 0.9438  time: 0.1075  data_time: 0.0032  lr: 3.50e-04  max_mem: 1189M
[03/10 22:20:18] fastreid.utils.events INFO:  eta: 0:18:33  epoch/iter: 6/20999  total_loss: 29.33  loss_cls: 28.21  loss_triplet: 1.049  time: 0.1075  data_time: 0.0034  lr: 3.50e-04  max_mem: 1189M
[03/10 22:20:40] fastreid.utils.events INFO:  eta: 0:18:39  epoch/iter: 6/21199  total_loss: 28.96  loss_cls: 28  loss_triplet: 1.023  time: 0.1075  data_time: 0.0026  lr: 3.50e-04  max_mem: 1189M
[03/10 22:21:02] fastreid.utils.events INFO:  eta: 0:18:17  epoch/iter: 6/21399  total_loss: 29.86  loss_cls: 28.81  loss_triplet: 1.095  time: 0.1076  data_time: 0.0027  lr: 3.50e-04  max_mem: 1189M
[03/10 22:21:25] fastreid.utils.events INFO:  eta: 0:17:55  epoch/iter: 6/21599  total_loss: 29.64  loss_cls: 28.58  loss_triplet: 1.022  time: 0.1076  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/10 22:21:47] fastreid.utils.events INFO:  eta: 0:17:30  epoch/iter: 6/21799  total_loss: 29.86  loss_cls: 28.85  loss_triplet: 1.07  time: 0.1076  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/10 22:21:55] fastreid.utils.events INFO:  eta: 0:17:21  epoch/iter: 6/21874  total_loss: 30.24  loss_cls: 29.31  loss_triplet: 1.123  time: 0.1076  data_time: 0.0019  lr: 3.50e-04  max_mem: 1189M
[03/10 22:22:09] fastreid.utils.events INFO:  eta: 0:17:06  epoch/iter: 7/21999  total_loss: 30.76  loss_cls: 29.65  loss_triplet: 1.11  time: 0.1077  data_time: 0.0024  lr: 3.50e-04  max_mem: 1189M
[03/10 22:22:31] fastreid.utils.events INFO:  eta: 0:16:42  epoch/iter: 7/22199  total_loss: 30.75  loss_cls: 29.56  loss_triplet: 0.9882  time: 0.1077  data_time: 0.0020  lr: 3.50e-04  max_mem: 1189M
[03/10 22:22:53] fastreid.utils.events INFO:  eta: 0:16:18  epoch/iter: 7/22399  total_loss: 30.23  loss_cls: 29.34  loss_triplet: 0.9314  time: 0.1077  data_time: 0.0016  lr: 3.50e-04  max_mem: 1189M
[03/10 22:23:15] fastreid.utils.events INFO:  eta: 0:15:54  epoch/iter: 7/22599  total_loss: 30.7  loss_cls: 29.69  loss_triplet: 1.001  time: 0.1077  data_time: 0.0021  lr: 3.50e-04  max_mem: 1189M
[03/10 22:23:37] fastreid.utils.events INFO:  eta: 0:15:31  epoch/iter: 7/22799  total_loss: 30.54  loss_cls: 29.53  loss_triplet: 1.029  time: 0.1077  data_time: 0.0014  lr: 3.50e-04  max_mem: 1189M
[03/10 22:23:59] fastreid.utils.events INFO:  eta: 0:15:07  epoch/iter: 7/22999  total_loss: 31.23  loss_cls: 30.08  loss_triplet: 1.02  time: 0.1078  data_time: 0.0014  lr: 3.50e-04  max_mem: 1189M
[03/10 22:24:21] fastreid.utils.events INFO:  eta: 0:14:44  epoch/iter: 7/23199  total_loss: 31.73  loss_cls: 30.65  loss_triplet: 1.03  time: 0.1078  data_time: 0.0013  lr: 3.50e-04  max_mem: 1189M
[03/10 22:24:43] fastreid.utils.events INFO:  eta: 0:14:21  epoch/iter: 7/23399  total_loss: 31.18  loss_cls: 30.06  loss_triplet: 0.9304  time: 0.1078  data_time: 0.0013  lr: 3.50e-04  max_mem: 1189M
[03/10 22:25:04] fastreid.utils.events INFO:  eta: 0:13:58  epoch/iter: 7/23599  total_loss: 31.85  loss_cls: 30.77  loss_triplet: 0.9871  time: 0.1078  data_time: 0.0010  lr: 3.50e-04  max_mem: 1189M
[03/10 22:25:26] fastreid.utils.events INFO:  eta: 0:13:35  epoch/iter: 7/23799  total_loss: 31.96  loss_cls: 30.99  loss_triplet: 1.023  time: 0.1078  data_time: 0.0006  lr: 3.50e-04  max_mem: 1189M
[03/10 22:25:48] fastreid.utils.events INFO:  eta: 0:13:11  epoch/iter: 7/23999  total_loss: 32.52  loss_cls: 31.32  loss_triplet: 1.056  time: 0.1078  data_time: 0.0006  lr: 3.50e-04  max_mem: 1189M
[03/10 22:26:10] fastreid.utils.events INFO:  eta: 0:12:48  epoch/iter: 7/24199  total_loss: 32.33  loss_cls: 31.3  loss_triplet: 0.9943  time: 0.1078  data_time: 0.0004  lr: 3.50e-04  max_mem: 1189M
[03/10 22:26:31] fastreid.utils.events INFO:  eta: 0:12:24  epoch/iter: 7/24399  total_loss: 32.18  loss_cls: 31.41  loss_triplet: 0.9953  time: 0.1078  data_time: 0.0004  lr: 3.50e-04  max_mem: 1189M
[03/10 22:26:53] fastreid.utils.events INFO:  eta: 0:12:01  epoch/iter: 7/24599  total_loss: 32.3  loss_cls: 31.2  loss_triplet: 1.086  time: 0.1078  data_time: 0.0003  lr: 3.50e-04  max_mem: 1189M
[03/10 22:27:15] fastreid.utils.events INFO:  eta: 0:11:39  epoch/iter: 7/24799  total_loss: 28.99  loss_cls: 28.02  loss_triplet: 1.044  time: 0.1079  data_time: 0.0031  lr: 3.50e-04  max_mem: 1189M
[03/10 22:27:37] fastreid.utils.events INFO:  eta: 0:11:18  epoch/iter: 7/24999  total_loss: 28.5  loss_cls: 27.46  loss_triplet: 0.8951  time: 0.1079  data_time: 0.0030  lr: 3.50e-04  max_mem: 1189M
[03/10 22:27:37] fastreid.utils.events INFO:  eta: 0:11:18  epoch/iter: 7/24999  total_loss: 28.5  loss_cls: 27.46  loss_triplet: 0.8951  time: 0.1079  data_time: 0.0030  lr: 3.50e-04  max_mem: 1189M
[03/10 22:28:00] fastreid.utils.events INFO:  eta: 0:11:12  epoch/iter: 8/25199  total_loss: 28.72  loss_cls: 27.75  loss_triplet: 0.9418  time: 0.1079  data_time: 0.0033  lr: 3.50e-04  max_mem: 1189M
[03/10 22:28:22] fastreid.utils.events INFO:  eta: 0:10:52  epoch/iter: 8/25399  total_loss: 28.84  loss_cls: 27.92  loss_triplet: 0.8952  time: 0.1079  data_time: 0.0022  lr: 3.50e-04  max_mem: 1189M
[03/10 22:28:44] fastreid.utils.events INFO:  eta: 0:10:30  epoch/iter: 8/25599  total_loss: 28.78  loss_cls: 27.93  loss_triplet: 0.8824  time: 0.1080  data_time: 0.0024  lr: 3.50e-04  max_mem: 1189M
[03/10 22:29:06] fastreid.utils.events INFO:  eta: 0:10:07  epoch/iter: 8/25799  total_loss: 28.88  loss_cls: 27.99  loss_triplet: 0.8881  time: 0.1080  data_time: 0.0027  lr: 3.50e-04  max_mem: 1189M
[03/10 22:29:29] fastreid.utils.events INFO:  eta: 0:09:43  epoch/iter: 8/25999  total_loss: 29.26  loss_cls: 28.41  loss_triplet: 0.9429  time: 0.1080  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/10 22:29:51] fastreid.utils.events INFO:  eta: 0:09:20  epoch/iter: 8/26199  total_loss: 29.18  loss_cls: 28.49  loss_triplet: 0.8528  time: 0.1080  data_time: 0.0021  lr: 3.50e-04  max_mem: 1189M
[03/10 22:30:13] fastreid.utils.events INFO:  eta: 0:08:57  epoch/iter: 8/26399  total_loss: 29.8  loss_cls: 28.83  loss_triplet: 0.8999  time: 0.1080  data_time: 0.0019  lr: 3.50e-04  max_mem: 1189M
[03/10 22:30:35] fastreid.utils.events INFO:  eta: 0:08:35  epoch/iter: 8/26599  total_loss: 29.91  loss_cls: 28.94  loss_triplet: 0.96  time: 0.1081  data_time: 0.0020  lr: 3.50e-04  max_mem: 1189M
[03/10 22:30:57] fastreid.utils.events INFO:  eta: 0:08:12  epoch/iter: 8/26799  total_loss: 29.99  loss_cls: 29.12  loss_triplet: 0.9206  time: 0.1081  data_time: 0.0016  lr: 3.50e-04  max_mem: 1189M
[03/10 22:31:19] fastreid.utils.events INFO:  eta: 0:07:50  epoch/iter: 8/26999  total_loss: 30.16  loss_cls: 29.29  loss_triplet: 0.8291  time: 0.1081  data_time: 0.0015  lr: 3.50e-04  max_mem: 1189M
[03/10 22:31:41] fastreid.utils.events INFO:  eta: 0:07:26  epoch/iter: 8/27199  total_loss: 31.21  loss_cls: 30.29  loss_triplet: 0.9204  time: 0.1081  data_time: 0.0014  lr: 3.50e-04  max_mem: 1189M
[03/10 22:32:03] fastreid.utils.events INFO:  eta: 0:07:04  epoch/iter: 8/27399  total_loss: 30.92  loss_cls: 29.95  loss_triplet: 0.8866  time: 0.1081  data_time: 0.0010  lr: 3.50e-04  max_mem: 1189M
[03/10 22:32:25] fastreid.utils.events INFO:  eta: 0:06:41  epoch/iter: 8/27599  total_loss: 30.99  loss_cls: 30.11  loss_triplet: 0.8813  time: 0.1081  data_time: 0.0009  lr: 3.50e-04  max_mem: 1189M
[03/10 22:32:47] fastreid.utils.events INFO:  eta: 0:06:18  epoch/iter: 8/27799  total_loss: 32.05  loss_cls: 31.19  loss_triplet: 0.9379  time: 0.1081  data_time: 0.0008  lr: 3.50e-04  max_mem: 1189M
[03/10 22:33:09] fastreid.utils.events INFO:  eta: 0:05:56  epoch/iter: 8/27999  total_loss: 31.5  loss_cls: 30.71  loss_triplet: 0.8646  time: 0.1081  data_time: 0.0007  lr: 3.50e-04  max_mem: 1189M
[03/10 22:33:22] fastreid.utils.events INFO:  eta: 0:05:42  epoch/iter: 8/28124  total_loss: 31.61  loss_cls: 30.68  loss_triplet: 0.8417  time: 0.1081  data_time: 0.0005  lr: 3.50e-04  max_mem: 1189M
[03/10 22:33:30] fastreid.utils.events INFO:  eta: 0:05:33  epoch/iter: 9/28199  total_loss: 31.87  loss_cls: 30.96  loss_triplet: 0.9037  time: 0.1082  data_time: 0.0005  lr: 3.50e-04  max_mem: 1189M
[03/10 22:33:52] fastreid.utils.events INFO:  eta: 0:05:11  epoch/iter: 9/28399  total_loss: 32.41  loss_cls: 31.52  loss_triplet: 0.9554  time: 0.1082  data_time: 0.0004  lr: 3.50e-04  max_mem: 1189M
[03/10 22:34:14] fastreid.utils.events INFO:  eta: 0:04:48  epoch/iter: 9/28599  total_loss: 32.61  loss_cls: 31.88  loss_triplet: 0.9361  time: 0.1082  data_time: 0.0003  lr: 3.50e-04  max_mem: 1189M
[03/10 22:34:36] fastreid.utils.events INFO:  eta: 0:04:26  epoch/iter: 9/28799  total_loss: 29.31  loss_cls: 28.43  loss_triplet: 0.9801  time: 0.1082  data_time: 0.0032  lr: 3.50e-04  max_mem: 1189M
[03/10 22:34:58] fastreid.utils.events INFO:  eta: 0:04:05  epoch/iter: 9/28999  total_loss: 27.48  loss_cls: 26.74  loss_triplet: 0.7736  time: 0.1082  data_time: 0.0032  lr: 3.50e-04  max_mem: 1189M
[03/10 22:35:21] fastreid.utils.events INFO:  eta: 0:03:43  epoch/iter: 9/29199  total_loss: 27.52  loss_cls: 26.73  loss_triplet: 0.8221  time: 0.1082  data_time: 0.0031  lr: 3.50e-04  max_mem: 1189M
[03/10 22:35:43] fastreid.utils.events INFO:  eta: 0:03:26  epoch/iter: 9/29399  total_loss: 28.97  loss_cls: 28  loss_triplet: 0.8426  time: 0.1082  data_time: 0.0024  lr: 3.50e-04  max_mem: 1189M
[03/10 22:36:05] fastreid.utils.events INFO:  eta: 0:03:04  epoch/iter: 9/29599  total_loss: 29  loss_cls: 28.12  loss_triplet: 0.8415  time: 0.1083  data_time: 0.0027  lr: 3.50e-04  max_mem: 1189M
[03/10 22:36:27] fastreid.utils.events INFO:  eta: 0:02:41  epoch/iter: 9/29799  total_loss: 28.87  loss_cls: 28.14  loss_triplet: 0.825  time: 0.1083  data_time: 0.0025  lr: 3.50e-04  max_mem: 1189M
[03/10 22:36:49] fastreid.utils.events INFO:  eta: 0:02:19  epoch/iter: 9/29999  total_loss: 28.96  loss_cls: 28.15  loss_triplet: 0.8085  time: 0.1083  data_time: 0.0022  lr: 3.50e-04  max_mem: 1189M
[03/10 22:37:12] fastreid.utils.events INFO:  eta: 0:01:56  epoch/iter: 9/30199  total_loss: 29  loss_cls: 28.34  loss_triplet: 0.7885  time: 0.1083  data_time: 0.0020  lr: 3.50e-04  max_mem: 1189M
[03/10 22:37:34] fastreid.utils.events INFO:  eta: 0:01:34  epoch/iter: 9/30399  total_loss: 29.56  loss_cls: 28.62  loss_triplet: 0.8578  time: 0.1083  data_time: 0.0018  lr: 3.50e-04  max_mem: 1189M
[03/10 22:37:56] fastreid.utils.events INFO:  eta: 0:01:11  epoch/iter: 9/30599  total_loss: 29.73  loss_cls: 28.79  loss_triplet: 0.8263  time: 0.1083  data_time: 0.0015  lr: 3.50e-04  max_mem: 1189M
[03/10 22:38:18] fastreid.utils.events INFO:  eta: 0:00:49  epoch/iter: 9/30799  total_loss: 29.57  loss_cls: 28.91  loss_triplet: 0.8332  time: 0.1083  data_time: 0.0018  lr: 3.50e-04  max_mem: 1189M
[03/10 22:38:40] fastreid.utils.events INFO:  eta: 0:00:27  epoch/iter: 9/30999  total_loss: 30.42  loss_cls: 29.5  loss_triplet: 0.8461  time: 0.1084  data_time: 0.0012  lr: 3.50e-04  max_mem: 1189M
[03/10 22:39:02] fastreid.utils.events INFO:  eta: 0:00:05  epoch/iter: 9/31199  total_loss: 29.99  loss_cls: 29.23  loss_triplet: 0.8183  time: 0.1084  data_time: 0.0012  lr: 3.50e-04  max_mem: 1189M
[03/10 22:39:07] fastreid.utils.events INFO:  eta: 0:00:00  epoch/iter: 9/31249  total_loss: 30.29  loss_cls: 29.38  loss_triplet: 0.8114  time: 0.1084  data_time: 0.0013  lr: 3.50e-04  max_mem: 1189M
[03/10 22:39:07] fastreid.engine.defaults INFO: Prepare testing set
[03/10 22:39:08] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| query    | 12539   | 59999      | 1           |
| gallery  | 13781   | 100000     | 1           |[0m
[03/10 22:39:08] fastreid.evaluation.evaluator INFO: Start inference on 159999 images
[03/10 22:39:08] fastreid.evaluation.evaluator INFO: Inference done 11/1250. 0.0018 s / batch. ETA=0:00:13
[03/10 22:39:25] fastreid.evaluation.evaluator INFO: Total inference time: 0:00:16.604834 (0.013337 s / batch per device, on 1 devices)
[03/10 22:39:25] fastreid.evaluation.evaluator INFO: Total inference pure compute time: 0:00:02 (0.002113 s / batch per device, on 1 devices)
[03/10 22:39:32] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "./fastreid/engine/train_loop.py", line 148, in train
    self.after_epoch()
  File "./fastreid/engine/train_loop.py", line 182, in after_epoch
    h.after_epoch()
  File "./fastreid/engine/hooks.py", line 377, in after_epoch
    self._do_eval()
  File "./fastreid/engine/hooks.py", line 351, in _do_eval
    results = self._func()
  File "./fastreid/engine/defaults.py", line 305, in test_and_save_results
    self._last_eval_results = self.test(self.cfg, self.model)
  File "./fastreid/engine/defaults.py", line 441, in test
    results_i = inference_on_dataset(model, data_loader, evaluator, flip_test=cfg.TEST.FLIP.ENABLED)
  File "./fastreid/evaluation/evaluator.py", line 156, in inference_on_dataset
    results = evaluator.evaluate()
  File "./fastreid/evaluation/reid_evaluation.py", line 108, in evaluate
    indexes = faiss_index.search(query_features.numpy(), gallery_features.shape[0])[1]
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/faiss/__init__.py", line 313, in replacement_search
    D = np.empty((n, k), dtype=np.float32)
numpy.core._exceptions._ArrayMemoryError: Unable to allocate 22.4 GiB for an array with shape (59999, 100000) and data type float32
[03/10 22:39:32] fastreid.engine.hooks INFO: Overall training speed: 31248 iterations in 0:56:26 (0.1084 s / it)
[03/10 22:39:32] fastreid.engine.hooks INFO: Total training time: 0:57:55 (0:01:28 on hooks)
[03/10 23:21:31] fastreid INFO: Rank of current process: 0. World size: 1
[03/10 23:21:32] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               /opt/cuda
Pillow                  9.0.1
torchvision             0.12.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75, sm_80, sm_86
cv2                     4.5.5
----------------------  -----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[03/10 23:21:32] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=True)
[03/10 23:21:32] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/10 23:21:32] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 7
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/10 23:21:32] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/10 23:21:32] fastreid.utils.env INFO: Using a generated random seed 32596360
[03/10 23:21:32] fastreid.engine.defaults INFO: Prepare training set
[03/10 23:21:33] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 14889   | 200000     | 1           |[0m
[03/10 23:21:33] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/10 23:21:35] fastreid.engine.defaults INFO: Auto-scaling the num_classes=14889
[03/10 23:21:35] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=14889, scale=64, margin=0.35)
  )
)
[03/10 23:21:35] fastreid.utils.checkpoint INFO: Loading checkpoint from logs/NAIC2021Reid/sbs_mlp2x/model_final.pth
[03/10 23:21:36] fastreid.utils.checkpoint WARNING: Skip loading parameter 'heads.weight' to the model due to incompatible shapes: (38, 2048) in the checkpoint but (14889, 2048) in the model! You might want to double check if this is expected.
[03/10 23:21:36] fastreid.utils.checkpoint INFO: Some model parameters or buffers are not found in the checkpoint:
  [34mheads.weight[0m
[03/10 23:21:36] fastreid.utils.checkpoint INFO: Loading optimizer from logs/NAIC2021Reid/sbs_mlp2x/model_final.pth
[03/10 23:21:36] fastreid.utils.checkpoint INFO: Loading lr_sched from logs/NAIC2021Reid/sbs_mlp2x/model_final.pth
[03/10 23:21:36] fastreid.utils.checkpoint INFO: Loading warmup_sched from logs/NAIC2021Reid/sbs_mlp2x/model_final.pth
[03/10 23:21:36] fastreid.engine.train_loop INFO: Starting training from epoch 10
[03/10 23:21:36] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/10 23:24:48] fastreid INFO: Rank of current process: 0. World size: 1
[03/10 23:24:49] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               /opt/cuda
Pillow                  9.0.1
torchvision             0.12.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75, sm_80, sm_86
cv2                     4.5.5
----------------------  -----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[03/10 23:24:49] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=True)
[03/10 23:24:49] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/10 23:24:49] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 30
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/10 23:24:49] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/10 23:24:49] fastreid.utils.env INFO: Using a generated random seed 49085124
[03/10 23:24:49] fastreid.engine.defaults INFO: Prepare training set
[03/10 23:24:49] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 14889   | 200000     | 1           |[0m
[03/10 23:24:49] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/10 23:24:51] fastreid.engine.defaults INFO: Auto-scaling the num_classes=14889
[03/10 23:24:51] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=14889, scale=64, margin=0.35)
  )
)
[03/10 23:24:51] fastreid.utils.checkpoint INFO: Loading checkpoint from logs/NAIC2021Reid/sbs_mlp2x/model_final.pth
[03/10 23:24:51] fastreid.utils.checkpoint WARNING: Skip loading parameter 'heads.weight' to the model due to incompatible shapes: (38, 2048) in the checkpoint but (14889, 2048) in the model! You might want to double check if this is expected.
[03/10 23:24:51] fastreid.utils.checkpoint INFO: Some model parameters or buffers are not found in the checkpoint:
  [34mheads.weight[0m
[03/10 23:24:51] fastreid.utils.checkpoint INFO: Loading optimizer from logs/NAIC2021Reid/sbs_mlp2x/model_final.pth
[03/10 23:24:51] fastreid.utils.checkpoint INFO: Loading lr_sched from logs/NAIC2021Reid/sbs_mlp2x/model_final.pth
[03/10 23:24:51] fastreid.utils.checkpoint INFO: Loading warmup_sched from logs/NAIC2021Reid/sbs_mlp2x/model_final.pth
[03/10 23:24:51] fastreid.engine.train_loop INFO: Starting training from epoch 10
[03/10 23:24:52] fastreid.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "./fastreid/engine/train_loop.py", line 145, in train
    self.run_step()
  File "./fastreid/engine/defaults.py", line 359, in run_step
    self._trainer.run_step()
  File "./fastreid/engine/train_loop.py", line 351, in run_step
    self.grad_scaler.step(self.optimizer)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/cuda/amp/grad_scaler.py", line 338, in step
    retval = self._maybe_opt_step(optimizer, optimizer_state, *args, **kwargs)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/cuda/amp/grad_scaler.py", line 285, in _maybe_opt_step
    retval = optimizer.step(*args, **kwargs)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/optim/lr_scheduler.py", line 65, in wrapper
    return wrapped(*args, **kwargs)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/optim/optimizer.py", line 88, in wrapper
    return func(*args, **kwargs)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/optim/adam.py", line 153, in step
    maximize=group['maximize'])
  File "/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch/optim/_functional.py", line 97, in adam
    exp_avg.mul_(beta1).add_(grad, alpha=1 - beta1)
RuntimeError: The size of tensor a (8476673) must match the size of tensor b (38891521) at non-singleton dimension 0
[03/10 23:24:52] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/10 23:25:41] fastreid INFO: Rank of current process: 0. World size: 1
[03/10 23:25:42] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               /opt/cuda
Pillow                  9.0.1
torchvision             0.12.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75, sm_80, sm_86
cv2                     4.5.5
----------------------  -----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[03/10 23:25:42] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=True)
[03/10 23:25:42] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/10 23:25:42] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 0
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/10 23:25:42] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/10 23:25:42] fastreid.utils.env INFO: Using a generated random seed 42160576
[03/10 23:25:42] fastreid.engine.defaults INFO: Prepare training set
[03/10 23:25:42] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 14889   | 200000     | 1           |[0m
[03/10 23:25:42] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/10 23:25:44] fastreid.engine.defaults INFO: Auto-scaling the num_classes=14889
[03/10 23:25:45] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=14889, scale=64, margin=0.35)
  )
)
[03/10 23:25:45] fastreid.utils.checkpoint INFO: Loading checkpoint from logs/NAIC2021Reid/sbs_mlp2x/model_final.pth
[03/10 23:25:45] fastreid.utils.checkpoint WARNING: Skip loading parameter 'heads.weight' to the model due to incompatible shapes: (38, 2048) in the checkpoint but (14889, 2048) in the model! You might want to double check if this is expected.
[03/10 23:25:45] fastreid.utils.checkpoint INFO: Some model parameters or buffers are not found in the checkpoint:
  [34mheads.weight[0m
[03/10 23:25:45] fastreid.utils.checkpoint INFO: Loading optimizer from logs/NAIC2021Reid/sbs_mlp2x/model_final.pth
[03/10 23:25:45] fastreid.utils.checkpoint INFO: Loading lr_sched from logs/NAIC2021Reid/sbs_mlp2x/model_final.pth
[03/10 23:25:45] fastreid.utils.checkpoint INFO: Loading warmup_sched from logs/NAIC2021Reid/sbs_mlp2x/model_final.pth
[03/10 23:25:45] fastreid.engine.train_loop INFO: Starting training from epoch 10
[03/10 23:25:45] fastreid.engine.hooks INFO: Total training time: 0:00:00 (0:00:00 on hooks)
[03/10 23:38:04] fastreid INFO: Rank of current process: 0. World size: 1
[03/10 23:38:04] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------
sys.platform            linux
Python                  3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
numpy                   1.21.2
fastreid                1.3 @./fastreid
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA GeForce GTX 1650
CUDA_HOME               /opt/cuda
Pillow                  9.0.1
torchvision             0.12.0 @/home/gaoyulin/.conda/envs/fastreid/lib/python3.7/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75, sm_80, sm_86
cv2                     4.5.5
----------------------  -----------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[03/10 23:38:04] fastreid INFO: Command line arguments: Namespace(config_file='./configs/NAIC2021Reid/sbs_mlp2x.yml', dist_url='tcp://127.0.0.1:50152', eval_only=False, infer_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=['MODEL.DEVICE', 'cuda:0'], resume=False)
[03/10 23:38:04] fastreid INFO: Contents of args.config_file=./configs/NAIC2021Reid/sbs_mlp2x.yml:
_BASE_: ../Base-SBS.yml

MODEL:
  FREEZE_LAYERS: []
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  BACKBONE:
    NAME: build_mlp_backbone
    DEPTH: "2x"
    WITH_IBN: True
    PRETRAIN: False

INPUT:
  SIZE_TRAIN: [0, 0]
  SIZE_TEST: [0, 0]
  CROP:
    ENABLED: False
  FLIP:
    ENABLED: False
  PADDING:
    ENABLED: False
  CJ:
    ENABLED: False
  AFFINE:
    ENABLED: False
  AUTOAUG:
    ENABLED: False
  AUGMIX:
    ENABLED: False
  REA:
    ENABLED: False
  RPT:
    ENABLED: False

SOLVER:
  FREEZE_ITERS: 0

DATASETS:
  NAMES: ("NAIC2021ReidTrain",)
  TESTS: ("NAIC2021ReidTrain",)

TEST:
  FLIP:
    ENABLED: False
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True

OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x

[03/10 23:38:04] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 16
  NUM_WORKERS: 10
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('NAIC2021ReidTrain',)
  TESTS: ('NAIC2021ReidTrain',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.1
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: False
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: False
    PROB: 0.5
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [0, 0]
  SIZE_TRAIN: [0, 0]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.0
    DEPTH: 2x
    DROP_PATH_RATIO: 0.1
    DROP_RATIO: 0.0
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_mlp_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: True
    WITH_SE: False
  DEVICE: cuda:0
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: CircleSoftmax
    EMBEDDING_DIM: 0
    MARGIN: 0.35
    NAME: EmbeddingHead
    NECK_FEAT: after
    NORM: BN
    NUM_CLASSES: 0
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 64
    WITH_BNNECK: True
  LOSSES:
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COSFACE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss')
    TRI:
      HARD_MINING: True
      MARGIN: 0.0
      NORM_FEAT: False
      SCALE: 1.0
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [0]
  PIXEL_STD: [1]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/NAIC2021Reid/sbs_mlp2x
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 20
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 30
  ETA_MIN_LR: 7e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: CosineAnnealingLR
  STEPS: [40, 90]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 10
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  QUERY_RES_NUM: 0
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
  USE_FAISS_FOR_INDEX: True
[03/10 23:38:04] fastreid INFO: Full config saved to /home/gaoyulin/Documents/naic2022semi-final/logs/NAIC2021Reid/sbs_mlp2x/config.yaml
[03/10 23:38:04] fastreid.utils.env INFO: Using a generated random seed 4877566
[03/10 23:38:04] fastreid.engine.defaults INFO: Prepare training set
[03/10 23:38:05] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| train    | 14889   | 200000     | 1           |[0m
[03/10 23:38:05] fastreid.data.build INFO: Using training sampler NaiveIdentitySampler
[03/10 23:38:07] fastreid.engine.defaults INFO: Auto-scaling the num_classes=14889
[03/10 23:38:08] fastreid.engine.defaults INFO: Model:
Baseline(
  (backbone): Sequential(
    (0): Squeeze()
    (1): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
      (act): ReLU()
    )
    (2): MLPBlock(
      (bn): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (fc): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (3): Unsqueeze()
  )
  (heads): EmbeddingHead(
    (pool_layer): GeneralizedMeanPoolingP(Parameter containing:
    tensor([3.], device='cuda:0', requires_grad=True), output_size=(1, 1))
    (bottleneck): Sequential(
      (0): BatchNorm(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (cls_layer): CircleSoftmax(num_classes=14889, scale=64, margin=0.35)
  )
)
[03/10 23:38:08] fastreid.utils.checkpoint INFO: No checkpoint found. Training model from scratch
[03/10 23:38:08] fastreid.engine.train_loop INFO: Starting training from epoch 0
[03/10 23:38:30] fastreid.utils.events INFO:  eta: 0:37:06  epoch/iter: 0/199  total_loss: 60.07  loss_cls: 53.2  loss_triplet: 6.779  time: 0.0719  data_time: 0.0040  lr: 6.59e-05  max_mem: 1189M
[03/10 23:38:51] fastreid.utils.events INFO:  eta: 0:37:01  epoch/iter: 0/399  total_loss: 57.65  loss_cls: 53.3  loss_triplet: 4.431  time: 0.0722  data_time: 0.0041  lr: 9.74e-05  max_mem: 1189M
[03/10 23:39:12] fastreid.utils.events INFO:  eta: 0:37:06  epoch/iter: 0/599  total_loss: 58.58  loss_cls: 53.47  loss_triplet: 4.984  time: 0.0728  data_time: 0.0036  lr: 1.29e-04  max_mem: 1189M
[03/10 23:39:33] fastreid.utils.events INFO:  eta: 0:37:14  epoch/iter: 0/799  total_loss: 58.62  loss_cls: 53.41  loss_triplet: 5.181  time: 0.0730  data_time: 0.0035  lr: 1.60e-04  max_mem: 1189M
[03/10 23:39:54] fastreid.utils.events INFO:  eta: 0:37:07  epoch/iter: 0/999  total_loss: 58.92  loss_cls: 53.49  loss_triplet: 5.378  time: 0.0735  data_time: 0.0037  lr: 1.92e-04  max_mem: 1189M
[03/10 23:40:16] fastreid.utils.events INFO:  eta: 0:37:01  epoch/iter: 0/1199  total_loss: 59.16  loss_cls: 53.53  loss_triplet: 5.711  time: 0.0740  data_time: 0.0032  lr: 2.23e-04  max_mem: 1189M
[03/10 23:40:38] fastreid.utils.events INFO:  eta: 0:37:08  epoch/iter: 0/1399  total_loss: 59.71  loss_cls: 53.68  loss_triplet: 5.705  time: 0.0742  data_time: 0.0024  lr: 2.55e-04  max_mem: 1189M
[03/10 23:40:59] fastreid.utils.events INFO:  eta: 0:37:18  epoch/iter: 0/1599  total_loss: 60.51  loss_cls: 53.87  loss_triplet: 6.134  time: 0.0746  data_time: 0.0028  lr: 2.86e-04  max_mem: 1189M
[03/10 23:41:21] fastreid.utils.events INFO:  eta: 0:37:19  epoch/iter: 0/1799  total_loss: 60.87  loss_cls: 54  loss_triplet: 6.473  time: 0.0749  data_time: 0.0025  lr: 3.18e-04  max_mem: 1189M
[03/10 23:41:43] fastreid.utils.events INFO:  eta: 0:37:47  epoch/iter: 0/1999  total_loss: 60.73  loss_cls: 54.13  loss_triplet: 6.45  time: 0.0753  data_time: 0.0025  lr: 3.49e-04  max_mem: 1189M
[03/10 23:42:05] fastreid.utils.events INFO:  eta: 0:37:43  epoch/iter: 0/2199  total_loss: 60.62  loss_cls: 54.16  loss_triplet: 6.394  time: 0.0785  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/10 23:42:27] fastreid.utils.events INFO:  eta: 0:37:48  epoch/iter: 0/2399  total_loss: 60.47  loss_cls: 54.17  loss_triplet: 6.615  time: 0.0811  data_time: 0.0019  lr: 3.50e-04  max_mem: 1189M
[03/10 23:42:49] fastreid.utils.events INFO:  eta: 0:52:29  epoch/iter: 0/2599  total_loss: 60.39  loss_cls: 54.2  loss_triplet: 6.554  time: 0.0833  data_time: 0.0020  lr: 3.50e-04  max_mem: 1189M
[03/10 23:43:11] fastreid.utils.events INFO:  eta: 0:52:09  epoch/iter: 0/2799  total_loss: 59.61  loss_cls: 54.08  loss_triplet: 6.074  time: 0.0852  data_time: 0.0017  lr: 3.50e-04  max_mem: 1189M
[03/10 23:43:33] fastreid.utils.events INFO:  eta: 0:51:47  epoch/iter: 0/2999  total_loss: 59.81  loss_cls: 54.1  loss_triplet: 5.901  time: 0.0868  data_time: 0.0008  lr: 3.50e-04  max_mem: 1189M
[03/10 23:43:47] fastreid.utils.events INFO:  eta: 0:51:30  epoch/iter: 0/3124  total_loss: 59.64  loss_cls: 54.33  loss_triplet: 5.74  time: 0.0877  data_time: 0.0007  lr: 3.50e-04  max_mem: 1189M
[03/10 23:43:55] fastreid.utils.events INFO:  eta: 0:51:19  epoch/iter: 1/3199  total_loss: 59.64  loss_cls: 54.26  loss_triplet: 5.849  time: 0.0882  data_time: 0.0010  lr: 3.50e-04  max_mem: 1189M
[03/10 23:44:17] fastreid.utils.events INFO:  eta: 0:50:54  epoch/iter: 1/3399  total_loss: 59.05  loss_cls: 53.97  loss_triplet: 5.315  time: 0.0895  data_time: 0.0005  lr: 3.50e-04  max_mem: 1189M
[03/10 23:44:39] fastreid.utils.events INFO:  eta: 0:50:24  epoch/iter: 1/3599  total_loss: 59.13  loss_cls: 53.76  loss_triplet: 5.912  time: 0.0906  data_time: 0.0007  lr: 3.50e-04  max_mem: 1189M
[03/10 23:45:01] fastreid.utils.events INFO:  eta: 0:49:56  epoch/iter: 1/3799  total_loss: 58.38  loss_cls: 52.73  loss_triplet: 5.879  time: 0.0915  data_time: 0.0004  lr: 3.50e-04  max_mem: 1189M
[03/10 23:45:22] fastreid.utils.events INFO:  eta: 0:49:27  epoch/iter: 1/3999  total_loss: 57.03  loss_cls: 51.35  loss_triplet: 5.947  time: 0.0924  data_time: 0.0003  lr: 3.50e-04  max_mem: 1189M
[03/10 23:45:44] fastreid.utils.events INFO:  eta: 0:49:01  epoch/iter: 1/4199  total_loss: 51.02  loss_cls: 46.07  loss_triplet: 5.683  time: 0.0932  data_time: 0.0041  lr: 3.50e-04  max_mem: 1189M
[03/10 23:46:07] fastreid.utils.events INFO:  eta: 0:48:40  epoch/iter: 1/4399  total_loss: 51.12  loss_cls: 46.08  loss_triplet: 4.271  time: 0.0941  data_time: 0.0024  lr: 3.50e-04  max_mem: 1189M
[03/10 23:46:29] fastreid.utils.events INFO:  eta: 0:48:56  epoch/iter: 1/4599  total_loss: 50.95  loss_cls: 46.65  loss_triplet: 4.172  time: 0.0949  data_time: 0.0031  lr: 3.50e-04  max_mem: 1189M
[03/10 23:46:52] fastreid.utils.events INFO:  eta: 0:49:18  epoch/iter: 1/4799  total_loss: 49.37  loss_cls: 45.59  loss_triplet: 3.877  time: 0.0956  data_time: 0.0039  lr: 3.50e-04  max_mem: 1189M
[03/10 23:47:14] fastreid.utils.events INFO:  eta: 0:48:57  epoch/iter: 1/4999  total_loss: 48.86  loss_cls: 45.09  loss_triplet: 3.827  time: 0.0962  data_time: 0.0033  lr: 3.50e-04  max_mem: 1189M
[03/10 23:47:36] fastreid.utils.events INFO:  eta: 0:48:31  epoch/iter: 1/5199  total_loss: 49.2  loss_cls: 45.05  loss_triplet: 3.798  time: 0.0968  data_time: 0.0033  lr: 3.50e-04  max_mem: 1189M
[03/10 23:47:58] fastreid.utils.events INFO:  eta: 0:48:04  epoch/iter: 1/5399  total_loss: 49.81  loss_cls: 45.68  loss_triplet: 3.915  time: 0.0974  data_time: 0.0031  lr: 3.50e-04  max_mem: 1189M
[03/10 23:48:21] fastreid.utils.events INFO:  eta: 0:47:37  epoch/iter: 1/5599  total_loss: 49.5  loss_cls: 46.17  loss_triplet: 3.657  time: 0.0978  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/10 23:48:43] fastreid.utils.events INFO:  eta: 0:47:10  epoch/iter: 1/5799  total_loss: 48.73  loss_cls: 45.3  loss_triplet: 3.613  time: 0.0983  data_time: 0.0020  lr: 3.50e-04  max_mem: 1189M
[03/10 23:49:05] fastreid.utils.events INFO:  eta: 0:46:42  epoch/iter: 1/5999  total_loss: 49.18  loss_cls: 45.65  loss_triplet: 3.73  time: 0.0987  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/10 23:49:27] fastreid.utils.events INFO:  eta: 0:46:15  epoch/iter: 1/6199  total_loss: 49.43  loss_cls: 45.64  loss_triplet: 3.604  time: 0.0991  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/10 23:49:32] fastreid.utils.events INFO:  eta: 0:46:08  epoch/iter: 1/6249  total_loss: 49.01  loss_cls: 45.48  loss_triplet: 3.519  time: 0.0991  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/10 23:49:49] fastreid.utils.events INFO:  eta: 0:45:47  epoch/iter: 2/6399  total_loss: 49.18  loss_cls: 45.05  loss_triplet: 3.863  time: 0.0994  data_time: 0.0020  lr: 3.50e-04  max_mem: 1189M
[03/10 23:50:11] fastreid.utils.events INFO:  eta: 0:45:20  epoch/iter: 2/6599  total_loss: 49  loss_cls: 45.29  loss_triplet: 3.552  time: 0.0997  data_time: 0.0020  lr: 3.50e-04  max_mem: 1189M
[03/10 23:50:33] fastreid.utils.events INFO:  eta: 0:44:53  epoch/iter: 2/6799  total_loss: 48.69  loss_cls: 44.95  loss_triplet: 3.632  time: 0.1000  data_time: 0.0018  lr: 3.50e-04  max_mem: 1189M
[03/10 23:50:55] fastreid.utils.events INFO:  eta: 0:44:27  epoch/iter: 2/6999  total_loss: 48.11  loss_cls: 44.59  loss_triplet: 3.312  time: 0.1003  data_time: 0.0014  lr: 3.50e-04  max_mem: 1189M
[03/10 23:51:17] fastreid.utils.events INFO:  eta: 0:44:01  epoch/iter: 2/7199  total_loss: 48.8  loss_cls: 45.21  loss_triplet: 3.391  time: 0.1005  data_time: 0.0014  lr: 3.50e-04  max_mem: 1189M
[03/10 23:51:39] fastreid.utils.events INFO:  eta: 0:43:34  epoch/iter: 2/7399  total_loss: 47.49  loss_cls: 44.69  loss_triplet: 3.339  time: 0.1008  data_time: 0.0011  lr: 3.50e-04  max_mem: 1189M
[03/10 23:52:00] fastreid.utils.events INFO:  eta: 0:43:07  epoch/iter: 2/7599  total_loss: 47.81  loss_cls: 44.12  loss_triplet: 3.603  time: 0.1010  data_time: 0.0009  lr: 3.50e-04  max_mem: 1189M
[03/10 23:52:22] fastreid.utils.events INFO:  eta: 0:42:41  epoch/iter: 2/7799  total_loss: 47.94  loss_cls: 44.62  loss_triplet: 3.231  time: 0.1012  data_time: 0.0006  lr: 3.50e-04  max_mem: 1189M
[03/10 23:52:44] fastreid.utils.events INFO:  eta: 0:42:14  epoch/iter: 2/7999  total_loss: 45.88  loss_cls: 42.45  loss_triplet: 3.485  time: 0.1014  data_time: 0.0004  lr: 3.50e-04  max_mem: 1189M
[03/10 23:53:05] fastreid.utils.events INFO:  eta: 0:41:45  epoch/iter: 2/8199  total_loss: 44.23  loss_cls: 40.81  loss_triplet: 3.615  time: 0.1015  data_time: 0.0003  lr: 3.50e-04  max_mem: 1189M
[03/10 23:53:28] fastreid.utils.events INFO:  eta: 0:41:25  epoch/iter: 2/8399  total_loss: 37.24  loss_cls: 33.83  loss_triplet: 2.891  time: 0.1018  data_time: 0.0042  lr: 3.50e-04  max_mem: 1189M
[03/10 23:53:50] fastreid.utils.events INFO:  eta: 0:41:06  epoch/iter: 2/8599  total_loss: 36.52  loss_cls: 33.95  loss_triplet: 2.471  time: 0.1020  data_time: 0.0033  lr: 3.50e-04  max_mem: 1189M
[03/10 23:54:13] fastreid.utils.events INFO:  eta: 0:41:49  epoch/iter: 2/8799  total_loss: 36.97  loss_cls: 34.42  loss_triplet: 2.457  time: 0.1022  data_time: 0.0038  lr: 3.50e-04  max_mem: 1189M
[03/10 23:54:35] fastreid.utils.events INFO:  eta: 0:41:28  epoch/iter: 2/8999  total_loss: 36.72  loss_cls: 34.51  loss_triplet: 2.416  time: 0.1025  data_time: 0.0035  lr: 3.50e-04  max_mem: 1189M
[03/10 23:54:57] fastreid.utils.events INFO:  eta: 0:41:06  epoch/iter: 2/9199  total_loss: 37.2  loss_cls: 34.61  loss_triplet: 2.647  time: 0.1026  data_time: 0.0031  lr: 3.50e-04  max_mem: 1189M
[03/10 23:55:17] fastreid.utils.events INFO:  eta: 0:40:44  epoch/iter: 2/9374  total_loss: 37.4  loss_cls: 34.76  loss_triplet: 2.545  time: 0.1028  data_time: 0.0033  lr: 3.50e-04  max_mem: 1189M
[03/10 23:55:20] fastreid.utils.events INFO:  eta: 0:40:40  epoch/iter: 3/9399  total_loss: 38.01  loss_cls: 35.04  loss_triplet: 2.622  time: 0.1028  data_time: 0.0034  lr: 3.50e-04  max_mem: 1189M
[03/10 23:55:42] fastreid.utils.events INFO:  eta: 0:40:14  epoch/iter: 3/9599  total_loss: 37.28  loss_cls: 34.86  loss_triplet: 2.449  time: 0.1030  data_time: 0.0032  lr: 3.50e-04  max_mem: 1189M
[03/10 23:56:04] fastreid.utils.events INFO:  eta: 0:39:47  epoch/iter: 3/9799  total_loss: 36.48  loss_cls: 34.28  loss_triplet: 2.249  time: 0.1032  data_time: 0.0031  lr: 3.50e-04  max_mem: 1189M
[03/10 23:56:26] fastreid.utils.events INFO:  eta: 0:39:21  epoch/iter: 3/9999  total_loss: 37.38  loss_cls: 34.89  loss_triplet: 2.246  time: 0.1033  data_time: 0.0028  lr: 3.50e-04  max_mem: 1189M
[03/10 23:56:48] fastreid.utils.events INFO:  eta: 0:38:55  epoch/iter: 3/10199  total_loss: 37.42  loss_cls: 35.16  loss_triplet: 2.401  time: 0.1034  data_time: 0.0024  lr: 3.50e-04  max_mem: 1189M
[03/10 23:57:10] fastreid.utils.events INFO:  eta: 0:38:28  epoch/iter: 3/10399  total_loss: 37.64  loss_cls: 35.25  loss_triplet: 2.3  time: 0.1036  data_time: 0.0018  lr: 3.50e-04  max_mem: 1189M
[03/10 23:57:32] fastreid.utils.events INFO:  eta: 0:38:01  epoch/iter: 3/10599  total_loss: 36.77  loss_cls: 34.64  loss_triplet: 2.202  time: 0.1037  data_time: 0.0020  lr: 3.50e-04  max_mem: 1189M
[03/10 23:57:54] fastreid.utils.events INFO:  eta: 0:37:34  epoch/iter: 3/10799  total_loss: 37.21  loss_cls: 34.9  loss_triplet: 2.239  time: 0.1038  data_time: 0.0019  lr: 3.50e-04  max_mem: 1189M
[03/10 23:58:16] fastreid.utils.events INFO:  eta: 0:37:09  epoch/iter: 3/10999  total_loss: 37.22  loss_cls: 35.19  loss_triplet: 2.254  time: 0.1039  data_time: 0.0015  lr: 3.50e-04  max_mem: 1189M
[03/10 23:58:38] fastreid.utils.events INFO:  eta: 0:36:43  epoch/iter: 3/11199  total_loss: 37.33  loss_cls: 34.96  loss_triplet: 2.416  time: 0.1040  data_time: 0.0015  lr: 3.50e-04  max_mem: 1189M
[03/10 23:59:00] fastreid.utils.events INFO:  eta: 0:36:17  epoch/iter: 3/11399  total_loss: 36.61  loss_cls: 34.78  loss_triplet: 2.03  time: 0.1041  data_time: 0.0014  lr: 3.50e-04  max_mem: 1189M
[03/10 23:59:22] fastreid.utils.events INFO:  eta: 0:35:51  epoch/iter: 3/11599  total_loss: 37.68  loss_cls: 35.55  loss_triplet: 2.257  time: 0.1042  data_time: 0.0011  lr: 3.50e-04  max_mem: 1189M
[03/10 23:59:44] fastreid.utils.events INFO:  eta: 0:35:25  epoch/iter: 3/11799  total_loss: 37.25  loss_cls: 35.17  loss_triplet: 2.197  time: 0.1043  data_time: 0.0008  lr: 3.50e-04  max_mem: 1189M
[03/11 00:00:05] fastreid.utils.events INFO:  eta: 0:34:59  epoch/iter: 3/11999  total_loss: 36.68  loss_cls: 34.62  loss_triplet: 2.007  time: 0.1044  data_time: 0.0005  lr: 3.50e-04  max_mem: 1189M
[03/11 00:00:27] fastreid.utils.events INFO:  eta: 0:34:34  epoch/iter: 3/12199  total_loss: 37.14  loss_cls: 34.53  loss_triplet: 2.547  time: 0.1044  data_time: 0.0003  lr: 3.50e-04  max_mem: 1189M
[03/11 00:00:49] fastreid.utils.events INFO:  eta: 0:34:10  epoch/iter: 3/12399  total_loss: 33.43  loss_cls: 31.49  loss_triplet: 2.248  time: 0.1045  data_time: 0.0042  lr: 3.50e-04  max_mem: 1189M
[03/11 00:01:00] fastreid.utils.events INFO:  eta: 0:33:59  epoch/iter: 3/12499  total_loss: 31.9  loss_cls: 30.17  loss_triplet: 2.054  time: 0.1046  data_time: 0.0042  lr: 3.50e-04  max_mem: 1189M
[03/11 00:01:11] fastreid.utils.events INFO:  eta: 0:33:49  epoch/iter: 4/12599  total_loss: 31.91  loss_cls: 30.33  loss_triplet: 1.817  time: 0.1046  data_time: 0.0041  lr: 3.50e-04  max_mem: 1189M
[03/11 00:01:34] fastreid.utils.events INFO:  eta: 0:33:33  epoch/iter: 4/12799  total_loss: 31.98  loss_cls: 29.96  loss_triplet: 1.829  time: 0.1048  data_time: 0.0039  lr: 3.50e-04  max_mem: 1189M
[03/11 00:01:56] fastreid.utils.events INFO:  eta: 0:34:02  epoch/iter: 4/12999  total_loss: 31.97  loss_cls: 29.93  loss_triplet: 1.706  time: 0.1049  data_time: 0.0037  lr: 3.50e-04  max_mem: 1189M
[03/11 00:02:19] fastreid.utils.events INFO:  eta: 0:33:41  epoch/iter: 4/13199  total_loss: 32.14  loss_cls: 30.37  loss_triplet: 1.686  time: 0.1050  data_time: 0.0033  lr: 3.50e-04  max_mem: 1189M
[03/11 00:02:41] fastreid.utils.events INFO:  eta: 0:33:17  epoch/iter: 4/13399  total_loss: 32.93  loss_cls: 31.07  loss_triplet: 1.924  time: 0.1051  data_time: 0.0030  lr: 3.50e-04  max_mem: 1189M
[03/11 00:03:03] fastreid.utils.events INFO:  eta: 0:32:51  epoch/iter: 4/13599  total_loss: 32.5  loss_cls: 30.69  loss_triplet: 1.789  time: 0.1052  data_time: 0.0027  lr: 3.50e-04  max_mem: 1189M
[03/11 00:03:25] fastreid.utils.events INFO:  eta: 0:32:25  epoch/iter: 4/13799  total_loss: 32.63  loss_cls: 30.71  loss_triplet: 1.76  time: 0.1052  data_time: 0.0028  lr: 3.50e-04  max_mem: 1189M
[03/11 00:03:48] fastreid.utils.events INFO:  eta: 0:31:59  epoch/iter: 4/13999  total_loss: 33.06  loss_cls: 31.37  loss_triplet: 1.753  time: 0.1053  data_time: 0.0025  lr: 3.50e-04  max_mem: 1189M
[03/11 00:04:10] fastreid.utils.events INFO:  eta: 0:31:32  epoch/iter: 4/14199  total_loss: 32.95  loss_cls: 31.48  loss_triplet: 1.59  time: 0.1054  data_time: 0.0022  lr: 3.50e-04  max_mem: 1189M
[03/11 00:04:32] fastreid.utils.events INFO:  eta: 0:31:06  epoch/iter: 4/14399  total_loss: 32.87  loss_cls: 31.32  loss_triplet: 1.47  time: 0.1055  data_time: 0.0024  lr: 3.50e-04  max_mem: 1189M
[03/11 00:04:54] fastreid.utils.events INFO:  eta: 0:30:41  epoch/iter: 4/14599  total_loss: 32.83  loss_cls: 31.39  loss_triplet: 1.478  time: 0.1055  data_time: 0.0022  lr: 3.50e-04  max_mem: 1189M
[03/11 00:05:16] fastreid.utils.events INFO:  eta: 0:30:16  epoch/iter: 4/14799  total_loss: 32.47  loss_cls: 31.06  loss_triplet: 1.526  time: 0.1056  data_time: 0.0017  lr: 3.50e-04  max_mem: 1189M
[03/11 00:05:38] fastreid.utils.events INFO:  eta: 0:29:51  epoch/iter: 4/14999  total_loss: 33.03  loss_cls: 31.43  loss_triplet: 1.567  time: 0.1056  data_time: 0.0016  lr: 3.50e-04  max_mem: 1189M
[03/11 00:06:00] fastreid.utils.events INFO:  eta: 0:29:26  epoch/iter: 4/15199  total_loss: 33.41  loss_cls: 31.72  loss_triplet: 1.477  time: 0.1057  data_time: 0.0016  lr: 3.50e-04  max_mem: 1189M
[03/11 00:06:22] fastreid.utils.events INFO:  eta: 0:29:01  epoch/iter: 4/15399  total_loss: 33.16  loss_cls: 31.52  loss_triplet: 1.485  time: 0.1057  data_time: 0.0015  lr: 3.50e-04  max_mem: 1189M
[03/11 00:06:43] fastreid.utils.events INFO:  eta: 0:28:36  epoch/iter: 4/15599  total_loss: 33.83  loss_cls: 32.43  loss_triplet: 1.424  time: 0.1058  data_time: 0.0013  lr: 3.50e-04  max_mem: 1189M
[03/11 00:06:46] fastreid.utils.events INFO:  eta: 0:28:33  epoch/iter: 4/15624  total_loss: 33.78  loss_cls: 32.44  loss_triplet: 1.43  time: 0.1058  data_time: 0.0010  lr: 3.50e-04  max_mem: 1189M
[03/11 00:07:05] fastreid.utils.events INFO:  eta: 0:28:10  epoch/iter: 5/15799  total_loss: 33.74  loss_cls: 32.44  loss_triplet: 1.495  time: 0.1058  data_time: 0.0010  lr: 3.50e-04  max_mem: 1189M
[03/11 00:07:27] fastreid.utils.events INFO:  eta: 0:27:45  epoch/iter: 5/15999  total_loss: 33.72  loss_cls: 32.2  loss_triplet: 1.629  time: 0.1059  data_time: 0.0006  lr: 3.50e-04  max_mem: 1189M
[03/11 00:07:49] fastreid.utils.events INFO:  eta: 0:27:21  epoch/iter: 5/16199  total_loss: 34.39  loss_cls: 32.82  loss_triplet: 1.622  time: 0.1059  data_time: 0.0003  lr: 3.50e-04  max_mem: 1189M
[03/11 00:08:10] fastreid.utils.events INFO:  eta: 0:26:55  epoch/iter: 5/16399  total_loss: 33.69  loss_cls: 32.21  loss_triplet: 1.79  time: 0.1059  data_time: 0.0003  lr: 3.50e-04  max_mem: 1189M
[03/11 00:08:33] fastreid.utils.events INFO:  eta: 0:26:32  epoch/iter: 5/16599  total_loss: 30.69  loss_cls: 29.13  loss_triplet: 1.559  time: 0.1060  data_time: 0.0038  lr: 3.50e-04  max_mem: 1189M
[03/11 00:08:55] fastreid.utils.events INFO:  eta: 0:26:11  epoch/iter: 5/16799  total_loss: 30.14  loss_cls: 29.03  loss_triplet: 1.346  time: 0.1061  data_time: 0.0035  lr: 3.50e-04  max_mem: 1189M
[03/11 00:09:17] fastreid.utils.events INFO:  eta: 0:26:17  epoch/iter: 5/16999  total_loss: 29.88  loss_cls: 28.68  loss_triplet: 1.272  time: 0.1061  data_time: 0.0039  lr: 3.50e-04  max_mem: 1189M
[03/11 00:09:40] fastreid.utils.events INFO:  eta: 0:26:11  epoch/iter: 5/17199  total_loss: 30.57  loss_cls: 29.19  loss_triplet: 1.309  time: 0.1062  data_time: 0.0033  lr: 3.50e-04  max_mem: 1189M
[03/11 00:10:02] fastreid.utils.events INFO:  eta: 0:25:49  epoch/iter: 5/17399  total_loss: 30.01  loss_cls: 28.91  loss_triplet: 1.156  time: 0.1062  data_time: 0.0034  lr: 3.50e-04  max_mem: 1189M
[03/11 00:10:24] fastreid.utils.events INFO:  eta: 0:25:25  epoch/iter: 5/17599  total_loss: 29.86  loss_cls: 28.82  loss_triplet: 1.173  time: 0.1063  data_time: 0.0033  lr: 3.50e-04  max_mem: 1189M
[03/11 00:10:46] fastreid.utils.events INFO:  eta: 0:25:00  epoch/iter: 5/17799  total_loss: 30.76  loss_cls: 29.54  loss_triplet: 1.337  time: 0.1064  data_time: 0.0030  lr: 3.50e-04  max_mem: 1189M
[03/11 00:11:09] fastreid.utils.events INFO:  eta: 0:24:35  epoch/iter: 5/17999  total_loss: 31.24  loss_cls: 29.79  loss_triplet: 1.213  time: 0.1064  data_time: 0.0029  lr: 3.50e-04  max_mem: 1189M
[03/11 00:11:31] fastreid.utils.events INFO:  eta: 0:24:10  epoch/iter: 5/18199  total_loss: 31.53  loss_cls: 30.26  loss_triplet: 1.325  time: 0.1065  data_time: 0.0024  lr: 3.50e-04  max_mem: 1189M
[03/11 00:11:53] fastreid.utils.events INFO:  eta: 0:23:46  epoch/iter: 5/18399  total_loss: 31.37  loss_cls: 30.12  loss_triplet: 1.269  time: 0.1065  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/11 00:12:15] fastreid.utils.events INFO:  eta: 0:23:22  epoch/iter: 5/18599  total_loss: 31.59  loss_cls: 30.58  loss_triplet: 1.243  time: 0.1065  data_time: 0.0020  lr: 3.50e-04  max_mem: 1189M
[03/11 00:12:32] fastreid.utils.events INFO:  eta: 0:23:03  epoch/iter: 5/18749  total_loss: 31.93  loss_cls: 30.56  loss_triplet: 1.284  time: 0.1066  data_time: 0.0021  lr: 3.50e-04  max_mem: 1189M
[03/11 00:12:37] fastreid.utils.events INFO:  eta: 0:22:57  epoch/iter: 6/18799  total_loss: 31.97  loss_cls: 30.59  loss_triplet: 1.252  time: 0.1066  data_time: 0.0019  lr: 3.50e-04  max_mem: 1189M
[03/11 00:12:59] fastreid.utils.events INFO:  eta: 0:22:32  epoch/iter: 6/18999  total_loss: 32  loss_cls: 30.92  loss_triplet: 1.23  time: 0.1066  data_time: 0.0019  lr: 3.50e-04  max_mem: 1189M
[03/11 00:13:21] fastreid.utils.events INFO:  eta: 0:22:07  epoch/iter: 6/19199  total_loss: 32.4  loss_cls: 31.18  loss_triplet: 1.282  time: 0.1067  data_time: 0.0017  lr: 3.50e-04  max_mem: 1189M
[03/11 00:13:43] fastreid.utils.events INFO:  eta: 0:21:42  epoch/iter: 6/19399  total_loss: 31.85  loss_cls: 30.8  loss_triplet: 1.225  time: 0.1067  data_time: 0.0016  lr: 3.50e-04  max_mem: 1189M
[03/11 00:14:05] fastreid.utils.events INFO:  eta: 0:21:18  epoch/iter: 6/19599  total_loss: 32.75  loss_cls: 31.64  loss_triplet: 1.165  time: 0.1067  data_time: 0.0014  lr: 3.50e-04  max_mem: 1189M
[03/11 00:14:27] fastreid.utils.events INFO:  eta: 0:20:55  epoch/iter: 6/19799  total_loss: 33.24  loss_cls: 32.07  loss_triplet: 1.235  time: 0.1067  data_time: 0.0012  lr: 3.50e-04  max_mem: 1189M
[03/11 00:14:48] fastreid.utils.events INFO:  eta: 0:20:30  epoch/iter: 6/19999  total_loss: 32.89  loss_cls: 31.66  loss_triplet: 1.199  time: 0.1068  data_time: 0.0009  lr: 3.50e-04  max_mem: 1189M
[03/11 00:15:10] fastreid.utils.events INFO:  eta: 0:20:06  epoch/iter: 6/20199  total_loss: 33.11  loss_cls: 31.73  loss_triplet: 1.212  time: 0.1068  data_time: 0.0004  lr: 3.50e-04  max_mem: 1189M
[03/11 00:15:32] fastreid.utils.events INFO:  eta: 0:19:42  epoch/iter: 6/20399  total_loss: 33.13  loss_cls: 32.03  loss_triplet: 1.261  time: 0.1068  data_time: 0.0003  lr: 3.50e-04  max_mem: 1189M
[03/11 00:15:54] fastreid.utils.events INFO:  eta: 0:19:17  epoch/iter: 6/20599  total_loss: 30.99  loss_cls: 29.95  loss_triplet: 1.272  time: 0.1068  data_time: 0.0041  lr: 3.50e-04  max_mem: 1189M
[03/11 00:16:16] fastreid.utils.events INFO:  eta: 0:18:56  epoch/iter: 6/20799  total_loss: 28.63  loss_cls: 27.41  loss_triplet: 1.003  time: 0.1069  data_time: 0.0040  lr: 3.50e-04  max_mem: 1189M
[03/11 00:16:39] fastreid.utils.events INFO:  eta: 0:18:35  epoch/iter: 6/20999  total_loss: 29.14  loss_cls: 28.03  loss_triplet: 0.9881  time: 0.1069  data_time: 0.0035  lr: 3.50e-04  max_mem: 1189M
[03/11 00:17:01] fastreid.utils.events INFO:  eta: 0:18:42  epoch/iter: 6/21199  total_loss: 29.46  loss_cls: 28.37  loss_triplet: 1.057  time: 0.1070  data_time: 0.0034  lr: 3.50e-04  max_mem: 1189M
[03/11 00:17:23] fastreid.utils.events INFO:  eta: 0:18:21  epoch/iter: 6/21399  total_loss: 29.77  loss_cls: 28.71  loss_triplet: 0.9951  time: 0.1070  data_time: 0.0036  lr: 3.50e-04  max_mem: 1189M
[03/11 00:17:46] fastreid.utils.events INFO:  eta: 0:17:59  epoch/iter: 6/21599  total_loss: 29.4  loss_cls: 28.45  loss_triplet: 0.9564  time: 0.1070  data_time: 0.0035  lr: 3.50e-04  max_mem: 1189M
[03/11 00:18:08] fastreid.utils.events INFO:  eta: 0:17:35  epoch/iter: 6/21799  total_loss: 29.73  loss_cls: 28.73  loss_triplet: 1.003  time: 0.1071  data_time: 0.0032  lr: 3.50e-04  max_mem: 1189M
[03/11 00:18:16] fastreid.utils.events INFO:  eta: 0:17:26  epoch/iter: 6/21874  total_loss: 29.78  loss_cls: 28.83  loss_triplet: 1.019  time: 0.1071  data_time: 0.0024  lr: 3.50e-04  max_mem: 1189M
[03/11 00:18:30] fastreid.utils.events INFO:  eta: 0:17:11  epoch/iter: 7/21999  total_loss: 30.8  loss_cls: 29.56  loss_triplet: 1.086  time: 0.1071  data_time: 0.0030  lr: 3.50e-04  max_mem: 1189M
[03/11 00:18:52] fastreid.utils.events INFO:  eta: 0:16:47  epoch/iter: 7/22199  total_loss: 30.19  loss_cls: 29.04  loss_triplet: 1  time: 0.1071  data_time: 0.0026  lr: 3.50e-04  max_mem: 1189M
[03/11 00:19:14] fastreid.utils.events INFO:  eta: 0:16:23  epoch/iter: 7/22399  total_loss: 30  loss_cls: 28.97  loss_triplet: 1.02  time: 0.1072  data_time: 0.0027  lr: 3.50e-04  max_mem: 1189M
[03/11 00:19:36] fastreid.utils.events INFO:  eta: 0:15:59  epoch/iter: 7/22599  total_loss: 30.54  loss_cls: 29.51  loss_triplet: 1.003  time: 0.1072  data_time: 0.0024  lr: 3.50e-04  max_mem: 1189M
[03/11 00:19:58] fastreid.utils.events INFO:  eta: 0:15:35  epoch/iter: 7/22799  total_loss: 30.89  loss_cls: 29.98  loss_triplet: 1.053  time: 0.1072  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/11 00:20:20] fastreid.utils.events INFO:  eta: 0:15:11  epoch/iter: 7/22999  total_loss: 31.17  loss_cls: 30.03  loss_triplet: 1.037  time: 0.1073  data_time: 0.0019  lr: 3.50e-04  max_mem: 1189M
[03/11 00:20:42] fastreid.utils.events INFO:  eta: 0:14:47  epoch/iter: 7/23199  total_loss: 30.9  loss_cls: 29.99  loss_triplet: 1.021  time: 0.1073  data_time: 0.0019  lr: 3.50e-04  max_mem: 1189M
[03/11 00:21:04] fastreid.utils.events INFO:  eta: 0:14:24  epoch/iter: 7/23399  total_loss: 31.7  loss_cls: 30.59  loss_triplet: 1.014  time: 0.1073  data_time: 0.0017  lr: 3.50e-04  max_mem: 1189M
[03/11 00:21:26] fastreid.utils.events INFO:  eta: 0:14:00  epoch/iter: 7/23599  total_loss: 32  loss_cls: 31.09  loss_triplet: 1.015  time: 0.1073  data_time: 0.0015  lr: 3.50e-04  max_mem: 1189M
[03/11 00:21:48] fastreid.utils.events INFO:  eta: 0:13:37  epoch/iter: 7/23799  total_loss: 31.98  loss_cls: 31.18  loss_triplet: 0.9824  time: 0.1073  data_time: 0.0013  lr: 3.50e-04  max_mem: 1189M
[03/11 00:22:10] fastreid.utils.events INFO:  eta: 0:13:14  epoch/iter: 7/23999  total_loss: 31.86  loss_cls: 31.06  loss_triplet: 0.9328  time: 0.1074  data_time: 0.0010  lr: 3.50e-04  max_mem: 1189M
[03/11 00:22:32] fastreid.utils.events INFO:  eta: 0:12:50  epoch/iter: 7/24199  total_loss: 32.55  loss_cls: 31.42  loss_triplet: 1.037  time: 0.1074  data_time: 0.0006  lr: 3.50e-04  max_mem: 1189M
[03/11 00:22:53] fastreid.utils.events INFO:  eta: 0:12:26  epoch/iter: 7/24399  total_loss: 32.91  loss_cls: 31.68  loss_triplet: 1.093  time: 0.1074  data_time: 0.0005  lr: 3.50e-04  max_mem: 1189M
[03/11 00:23:15] fastreid.utils.events INFO:  eta: 0:12:03  epoch/iter: 7/24599  total_loss: 32.03  loss_cls: 30.95  loss_triplet: 1.096  time: 0.1074  data_time: 0.0003  lr: 3.50e-04  max_mem: 1189M
[03/11 00:23:37] fastreid.utils.events INFO:  eta: 0:11:41  epoch/iter: 7/24799  total_loss: 28.78  loss_cls: 27.91  loss_triplet: 1.026  time: 0.1074  data_time: 0.0036  lr: 3.50e-04  max_mem: 1189M
[03/11 00:24:00] fastreid.utils.events INFO:  eta: 0:11:20  epoch/iter: 7/24999  total_loss: 28.25  loss_cls: 27.49  loss_triplet: 0.8763  time: 0.1074  data_time: 0.0042  lr: 3.50e-04  max_mem: 1189M
[03/11 00:24:00] fastreid.utils.events INFO:  eta: 0:11:20  epoch/iter: 7/24999  total_loss: 28.25  loss_cls: 27.49  loss_triplet: 0.8763  time: 0.1074  data_time: 0.0042  lr: 3.50e-04  max_mem: 1189M
[03/11 00:24:22] fastreid.utils.events INFO:  eta: 0:11:09  epoch/iter: 8/25199  total_loss: 28.79  loss_cls: 27.81  loss_triplet: 0.8962  time: 0.1075  data_time: 0.0038  lr: 3.50e-04  max_mem: 1189M
[03/11 00:24:45] fastreid.utils.events INFO:  eta: 0:10:54  epoch/iter: 8/25399  total_loss: 29.11  loss_cls: 28.17  loss_triplet: 0.9527  time: 0.1075  data_time: 0.0035  lr: 3.50e-04  max_mem: 1189M
[03/11 00:25:07] fastreid.utils.events INFO:  eta: 0:10:32  epoch/iter: 8/25599  total_loss: 29.1  loss_cls: 28.13  loss_triplet: 0.9217  time: 0.1075  data_time: 0.0031  lr: 3.50e-04  max_mem: 1189M
[03/11 00:25:29] fastreid.utils.events INFO:  eta: 0:10:09  epoch/iter: 8/25799  total_loss: 28.85  loss_cls: 28.02  loss_triplet: 0.8607  time: 0.1076  data_time: 0.0030  lr: 3.50e-04  max_mem: 1189M
[03/11 00:25:51] fastreid.utils.events INFO:  eta: 0:09:45  epoch/iter: 8/25999  total_loss: 29.28  loss_cls: 28.35  loss_triplet: 0.9003  time: 0.1076  data_time: 0.0030  lr: 3.50e-04  max_mem: 1189M
[03/11 00:26:14] fastreid.utils.events INFO:  eta: 0:09:22  epoch/iter: 8/26199  total_loss: 28.93  loss_cls: 28.14  loss_triplet: 0.879  time: 0.1076  data_time: 0.0029  lr: 3.50e-04  max_mem: 1189M
[03/11 00:26:36] fastreid.utils.events INFO:  eta: 0:08:59  epoch/iter: 8/26399  total_loss: 29.66  loss_cls: 28.79  loss_triplet: 0.8547  time: 0.1077  data_time: 0.0027  lr: 3.50e-04  max_mem: 1189M
[03/11 00:26:58] fastreid.utils.events INFO:  eta: 0:08:36  epoch/iter: 8/26599  total_loss: 30.53  loss_cls: 29.59  loss_triplet: 0.9653  time: 0.1077  data_time: 0.0025  lr: 3.50e-04  max_mem: 1189M
[03/11 00:27:20] fastreid.utils.events INFO:  eta: 0:08:13  epoch/iter: 8/26799  total_loss: 30.24  loss_cls: 29.32  loss_triplet: 0.9047  time: 0.1077  data_time: 0.0025  lr: 3.50e-04  max_mem: 1189M
[03/11 00:27:42] fastreid.utils.events INFO:  eta: 0:07:50  epoch/iter: 8/26999  total_loss: 29.94  loss_cls: 29.19  loss_triplet: 0.8725  time: 0.1077  data_time: 0.0018  lr: 3.50e-04  max_mem: 1189M
[03/11 00:28:04] fastreid.utils.events INFO:  eta: 0:07:27  epoch/iter: 8/27199  total_loss: 30.82  loss_cls: 29.94  loss_triplet: 0.9035  time: 0.1077  data_time: 0.0019  lr: 3.50e-04  max_mem: 1189M
[03/11 00:28:26] fastreid.utils.events INFO:  eta: 0:07:04  epoch/iter: 8/27399  total_loss: 30.42  loss_cls: 29.62  loss_triplet: 0.8963  time: 0.1077  data_time: 0.0018  lr: 3.50e-04  max_mem: 1189M
[03/11 00:28:48] fastreid.utils.events INFO:  eta: 0:06:41  epoch/iter: 8/27599  total_loss: 31.07  loss_cls: 30.15  loss_triplet: 0.8883  time: 0.1078  data_time: 0.0015  lr: 3.50e-04  max_mem: 1189M
[03/11 00:29:10] fastreid.utils.events INFO:  eta: 0:06:18  epoch/iter: 8/27799  total_loss: 31.67  loss_cls: 30.77  loss_triplet: 0.9017  time: 0.1078  data_time: 0.0014  lr: 3.50e-04  max_mem: 1189M
[03/11 00:29:32] fastreid.utils.events INFO:  eta: 0:05:56  epoch/iter: 8/27999  total_loss: 31.78  loss_cls: 30.95  loss_triplet: 0.9146  time: 0.1078  data_time: 0.0011  lr: 3.50e-04  max_mem: 1189M
[03/11 00:29:45] fastreid.utils.events INFO:  eta: 0:05:42  epoch/iter: 8/28124  total_loss: 32.42  loss_cls: 31.4  loss_triplet: 0.9252  time: 0.1078  data_time: 0.0010  lr: 3.50e-04  max_mem: 1189M
[03/11 00:29:53] fastreid.utils.events INFO:  eta: 0:05:33  epoch/iter: 9/28199  total_loss: 32.01  loss_cls: 31.17  loss_triplet: 0.9303  time: 0.1078  data_time: 0.0010  lr: 3.50e-04  max_mem: 1189M
[03/11 00:30:15] fastreid.utils.events INFO:  eta: 0:05:11  epoch/iter: 9/28399  total_loss: 32.18  loss_cls: 31.33  loss_triplet: 0.9431  time: 0.1078  data_time: 0.0006  lr: 3.50e-04  max_mem: 1189M
[03/11 00:30:37] fastreid.utils.events INFO:  eta: 0:04:48  epoch/iter: 9/28599  total_loss: 32.65  loss_cls: 31.6  loss_triplet: 0.9637  time: 0.1078  data_time: 0.0004  lr: 3.50e-04  max_mem: 1189M
[03/11 00:30:58] fastreid.utils.events INFO:  eta: 0:04:26  epoch/iter: 9/28799  total_loss: 31.26  loss_cls: 30.32  loss_triplet: 1.014  time: 0.1078  data_time: 0.0019  lr: 3.50e-04  max_mem: 1189M
[03/11 00:31:21] fastreid.utils.events INFO:  eta: 0:04:04  epoch/iter: 9/28999  total_loss: 27.79  loss_cls: 26.91  loss_triplet: 0.8131  time: 0.1078  data_time: 0.0041  lr: 3.50e-04  max_mem: 1189M
[03/11 00:31:43] fastreid.utils.events INFO:  eta: 0:03:43  epoch/iter: 9/29199  total_loss: 28.16  loss_cls: 27.31  loss_triplet: 0.8154  time: 0.1079  data_time: 0.0035  lr: 3.50e-04  max_mem: 1189M
[03/11 00:32:06] fastreid.utils.events INFO:  eta: 0:03:26  epoch/iter: 9/29399  total_loss: 28.52  loss_cls: 27.6  loss_triplet: 0.8307  time: 0.1079  data_time: 0.0035  lr: 3.50e-04  max_mem: 1189M
[03/11 00:32:28] fastreid.utils.events INFO:  eta: 0:03:04  epoch/iter: 9/29599  total_loss: 28.33  loss_cls: 27.39  loss_triplet: 0.7882  time: 0.1079  data_time: 0.0034  lr: 3.50e-04  max_mem: 1189M
[03/11 00:32:50] fastreid.utils.events INFO:  eta: 0:02:42  epoch/iter: 9/29799  total_loss: 28.79  loss_cls: 28.01  loss_triplet: 0.8202  time: 0.1079  data_time: 0.0034  lr: 3.50e-04  max_mem: 1189M
[03/11 00:33:13] fastreid.utils.events INFO:  eta: 0:02:19  epoch/iter: 9/29999  total_loss: 29  loss_cls: 28.1  loss_triplet: 0.8304  time: 0.1080  data_time: 0.0032  lr: 3.50e-04  max_mem: 1189M
[03/11 00:33:35] fastreid.utils.events INFO:  eta: 0:01:57  epoch/iter: 9/30199  total_loss: 28.99  loss_cls: 28.19  loss_triplet: 0.7954  time: 0.1080  data_time: 0.0032  lr: 3.50e-04  max_mem: 1189M
[03/11 00:33:57] fastreid.utils.events INFO:  eta: 0:01:34  epoch/iter: 9/30399  total_loss: 29.25  loss_cls: 28.43  loss_triplet: 0.8516  time: 0.1080  data_time: 0.0029  lr: 3.50e-04  max_mem: 1189M
[03/11 00:34:19] fastreid.utils.events INFO:  eta: 0:01:12  epoch/iter: 9/30599  total_loss: 29.53  loss_cls: 28.65  loss_triplet: 0.8342  time: 0.1080  data_time: 0.0026  lr: 3.50e-04  max_mem: 1189M
[03/11 00:34:41] fastreid.utils.events INFO:  eta: 0:00:49  epoch/iter: 9/30799  total_loss: 29.81  loss_cls: 29.08  loss_triplet: 0.8164  time: 0.1080  data_time: 0.0024  lr: 3.50e-04  max_mem: 1189M
[03/11 00:35:03] fastreid.utils.events INFO:  eta: 0:00:27  epoch/iter: 9/30999  total_loss: 29.7  loss_cls: 28.8  loss_triplet: 0.8281  time: 0.1080  data_time: 0.0023  lr: 3.50e-04  max_mem: 1189M
[03/11 00:35:25] fastreid.utils.events INFO:  eta: 0:00:05  epoch/iter: 9/31199  total_loss: 30.24  loss_cls: 29.4  loss_triplet: 0.8333  time: 0.1081  data_time: 0.0020  lr: 3.50e-04  max_mem: 1189M
[03/11 00:35:31] fastreid.utils.events INFO:  eta: 0:00:00  epoch/iter: 9/31249  total_loss: 30.25  loss_cls: 29.44  loss_triplet: 0.8395  time: 0.1081  data_time: 0.0017  lr: 3.50e-04  max_mem: 1189M
[03/11 00:35:31] fastreid.engine.defaults INFO: Prepare testing set
[03/11 00:35:31] fastreid.data.datasets.bases INFO: => Loaded NAIC2021ReidTrain in csv format: 
[36m| subset   | # ids   | # images   | # cameras   |
|:---------|:--------|:-----------|:------------|
| query    | 6234    | 9999       | 1           |
| gallery  | 10458   | 30000      | 1           |[0m
[03/11 00:35:32] fastreid.evaluation.evaluator INFO: Start inference on 39999 images
[03/11 00:35:32] fastreid.evaluation.evaluator INFO: Inference done 11/313. 0.0022 s / batch. ETA=0:00:01
[03/11 00:35:33] fastreid.evaluation.evaluator INFO: Total inference time: 0:00:01.477578 (0.004797 s / batch per device, on 1 devices)
[03/11 00:35:33] fastreid.evaluation.evaluator INFO: Total inference pure compute time: 0:00:00 (0.002354 s / batch per device, on 1 devices)
